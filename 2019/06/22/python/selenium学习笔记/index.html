<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="damn1t">
  <!-- Open Graph Data -->
  <meta property="og:title" content="selenium学习笔记"/>
  <meta property="og:description" content="404" />
  <meta property="og:site_name" content="damn1t"/>
  <meta property="og:type" content="article" />
  <meta property="og:image" content="http://microvorld.com"/>
  
    <link rel="alternate" href="/atom.xml" title="damn1t" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>damn1t</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.light.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/default-banner-dark.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">selenium学习笔记</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/microvorld">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:<bubbl3@foxmail.com>">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By damn1t</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2019-06-22</span>
            <span class="time">15:12:24</span>
          </span>
          
        </div>
        <!-- Tags -->
        
          <div class="post-tags text-muted">
            Tags: 

<a class="tag" href="/tags/selenium/">#selenium</a>


          </div>
        
        <!-- Post Main Content -->
        <div class="post-content">
          <h1 id="selenium学习笔记"><a href="#selenium学习笔记" class="headerlink" title="selenium学习笔记"></a>selenium学习笔记</h1><p>selenium可以模拟浏览器登录，且提供了很多api方便用户调用</p>
<h2 id="常用api"><a href="#常用api" class="headerlink" title="常用api"></a>常用api</h2><h3 id="浏览器操作"><a href="#浏览器操作" class="headerlink" title="浏览器操作"></a>浏览器操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 刷新</span><br><span class="line">driver.refresh()</span><br><span class="line"> </span><br><span class="line"># 前进</span><br><span class="line">driver.forward()</span><br><span class="line"> </span><br><span class="line"># 后退</span><br><span class="line">driver.back()</span><br></pre></td></tr></table></figure>
<h3 id="获取标签元素"><a href="#获取标签元素" class="headerlink" title="获取标签元素"></a>获取标签元素</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 通过ID定位目标元素</span><br><span class="line">driver.find_element_by_id(&apos;i1&apos;)</span><br><span class="line"> </span><br><span class="line"># 通过className定位目标元素</span><br><span class="line">driver.find_element_by_class_name(&apos;c1&apos;)</span><br><span class="line"> </span><br><span class="line"># 通过name属性定位目标元素</span><br><span class="line">driver.find_element_by_name(&apos;n1&apos;)</span><br><span class="line"> </span><br><span class="line"># 通过Xpath定位目标元素</span><br><span class="line">driver.find_element_by_xpath(&apos;//*[@id=&quot;i1&quot;]&apos;)</span><br><span class="line"> </span><br><span class="line"># 通过css Selector定位目标元素</span><br><span class="line">driver.find_element_by_css_selector(&apos;#i1&apos;)</span><br><span class="line"> </span><br><span class="line"># 通过标签名称定位(注：在一个页面中，标签一定会重复，所以不用这个来进行定位)</span><br><span class="line">driver.find_element_by_tag_name(&apos;input&apos;)</span><br><span class="line"> </span><br><span class="line"># 通过标签中的文本查找元素</span><br><span class="line">driver.find_element_by_link_text(&apos;登录&apos;)</span><br><span class="line"> </span><br><span class="line"># 通过标签中文本的模糊匹配查找</span><br><span class="line">driver.find_elements_by_partial_link_text(&apos;录&apos;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>获取标签元素常用的一共有8种定位方式，而Selenium实际提供了18种定位方式，还有8种是上面的复数形式，这里就不一一介绍了，实际运用中并不常用，还有2种实际上是这上面所说16种的底层封装。参数化的一种调用方式而已。</p>
</blockquote>
<h3 id="Cookie操作"><a href="#Cookie操作" class="headerlink" title="Cookie操作"></a>Cookie操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 根据cookieKey，获取cookie信息</span><br><span class="line">cookie = driver.get_cookie(&apos;cookieKey&apos;)</span><br><span class="line"> </span><br><span class="line"># 获取所有cookie信息</span><br><span class="line">cookies = driver.get_cookies()</span><br><span class="line"> </span><br><span class="line"># 添加cookie，严格按照格式添加，cookie的key为name，value为value</span><br><span class="line">driver.add_cookie(&#123;&apos;name&apos;:&apos;tmp&apos;,&apos;value&apos;:&apos;123123123&apos;&#125;)</span><br><span class="line"> </span><br><span class="line"># 删除所有cookie信息</span><br><span class="line">driver.delete_all_cookies()</span><br><span class="line"> </span><br><span class="line"># 根据cookieKey删除对应cookie</span><br><span class="line">driver.delete_cookie(&apos;UiCode&apos;)</span><br></pre></td></tr></table></figure>
<h3 id="窗口操作"><a href="#窗口操作" class="headerlink" title="窗口操作"></a>窗口操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 获取当前浏览器的大小</span><br><span class="line">driver.get_window_size()</span><br><span class="line"> </span><br><span class="line"># 通过像素设置浏览器的大小</span><br><span class="line">driver.set_window_size(&apos;width&apos;,&apos;height&apos;)</span><br><span class="line"> </span><br><span class="line"># 获取当前窗口针对于Windows的位置的坐标x,y</span><br><span class="line">driver.get_window_position()</span><br><span class="line"> </span><br><span class="line"># 设置当前窗口针对Windows的位置，x,y</span><br><span class="line">driver.set_window_position(20,20)</span><br><span class="line"> </span><br><span class="line"># 最大化当前窗口,不需要传参</span><br><span class="line">driver.maximize_window()</span><br><span class="line"> </span><br><span class="line"># 返回当前操作的浏览器句柄</span><br><span class="line">driver.current_window_handle</span><br><span class="line"> </span><br><span class="line"># 返回所有打开server的浏览器句柄</span><br><span class="line">driver.window_handles</span><br></pre></td></tr></table></figure>
<h3 id="截取当前页面"><a href="#截取当前页面" class="headerlink" title="截取当前页面"></a>截取当前页面</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 获取当前页面的二进制图片数据，需要自己去写入文件</span><br><span class="line">driver.get_screenshot_as_png()</span><br><span class="line"> </span><br><span class="line"># as_png的上层封装，只需要传入图片名称自动写成图片</span><br><span class="line">driver.get_screenshot_as_file(&apos;fileName.png&apos;)</span><br></pre></td></tr></table></figure>
<h3 id="执行JavaScript语句"><a href="#执行JavaScript语句" class="headerlink" title="执行JavaScript语句"></a>执行JavaScript语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 执行JavaScript语句</span><br><span class="line">driver.execute_script(&apos;JavaScript Commond&apos;)</span><br><span class="line"> </span><br><span class="line"># 例：</span><br><span class="line"># 通过js来操作滚动条</span><br><span class="line"># 参数1：x  参数2： y</span><br><span class="line">window.scrollTo(100,400);</span><br></pre></td></tr></table></figure>
<h3 id="关闭与退出"><a href="#关闭与退出" class="headerlink" title="关闭与退出"></a>关闭与退出</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 当开启多个时，关闭当前页面</span><br><span class="line">driver.close()</span><br><span class="line"> </span><br><span class="line"># 退出并关闭所有页面驱动</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 返回页面源码</span><br><span class="line">driver.page_source</span><br><span class="line"> </span><br><span class="line"># 返回tag标题</span><br><span class="line">driver.title</span><br><span class="line"> </span><br><span class="line"># 返回当前Url</span><br><span class="line">driver.current_url</span><br><span class="line"> </span><br><span class="line"># 获取浏览器名称 如：chrome</span><br><span class="line">driver.name</span><br></pre></td></tr></table></figure>
<h3 id="ElementApi接口"><a href="#ElementApi接口" class="headerlink" title="ElementApi接口"></a>ElementApi接口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># 根据标签属性名称,获取属性value</span><br><span class="line">element.get_attribute(&apos;style&apos;)</span><br><span class="line"> </span><br><span class="line"># 向输入框输入字符串 如果input的type为file类型 可以输入文件绝对路径上传文件</span><br><span class="line">element.send_keys()</span><br><span class="line"> </span><br><span class="line"># 清除文本内容</span><br><span class="line">element.clear()</span><br><span class="line"> </span><br><span class="line"># 鼠标左键点击操作</span><br><span class="line">element.click()</span><br><span class="line"> </span><br><span class="line"># 通过属性名称获取属性</span><br><span class="line">element.get_property(&apos;id&apos;)</span><br><span class="line"> </span><br><span class="line"># 返回元素是否可见 True or False</span><br><span class="line">element.is_displayed()</span><br><span class="line"> </span><br><span class="line"># 返回元素是否被选中 True or False</span><br><span class="line">element.is_selected()</span><br><span class="line"> </span><br><span class="line"># 返回标签元素的名字</span><br><span class="line">element.tag_name</span><br><span class="line"> </span><br><span class="line"># 获取当前标签的宽和高</span><br><span class="line">element.size</span><br><span class="line"> </span><br><span class="line"># 获取元素的文本内容</span><br><span class="line">element.text</span><br><span class="line"> </span><br><span class="line"># 模仿回车按钮 提交数据</span><br><span class="line">element.submit()</span><br><span class="line"> </span><br><span class="line"># 获取当前元素的坐标</span><br><span class="line">element.location</span><br><span class="line"> </span><br><span class="line"># 截取图片</span><br><span class="line">element.screenshot()</span><br></pre></td></tr></table></figure>
<h3 id="常见异常"><a href="#常见异常" class="headerlink" title="常见异常"></a>常见异常</h3><blockquote>
<p>　　NoSuchElementException：没有找到元素</p>
<p>　　NoSuchFrameException：没有找到iframe</p>
<p>　　NoSuchWindowException:没找到窗口句柄handle</p>
<p>　　NoSuchAttributeException:属性错误</p>
<p>　　NoAlertPresentException：没找到alert弹出框</p>
<p>　　ElmentNotVisibleException：元素不可见</p>
<p>　　ElementNotSelectableException：元素没有被选中</p>
<p>　　TimeoutException：查找元素超时</p>
</blockquote>
<p>api: <a href="https://selenium-python.readthedocs.io/api.html" target="_blank" rel="noopener">https://selenium-python.readthedocs.io/api.html</a></p>
<h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><h3 id="1-headless下的截屏"><a href="#1-headless下的截屏" class="headerlink" title="1.headless下的截屏"></a>1.headless下的截屏</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.keys import Keys</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line">from selenium.webdriver.firefox.options import Options</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">chrome_options = Options()</span><br><span class="line">chrome_options.add_argument(&quot;--headless&quot;)</span><br><span class="line"></span><br><span class="line">url = &quot;https://bbs.pediy.com/thread-251690.htm&quot;</span><br><span class="line">#对应的chromedriver的放置目录</span><br><span class="line">driver = webdriver.Chrome(chrome_options=chrome_options)</span><br><span class="line"></span><br><span class="line">driver.get(url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">start_time=time.time()</span><br><span class="line">print(&apos;this is start_time &apos;,start_time)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(&quot;kw&quot;).send_keys(&quot;selenium webdriver&quot;)</span><br><span class="line">driver.find_element_by_id(&quot;su&quot;).click()</span><br><span class="line">time.sleep(3)</span><br><span class="line">driver.save_screenshot(&apos;screen.png&apos;)</span><br><span class="line"></span><br><span class="line">driver.close()</span><br><span class="line"></span><br><span class="line">end_time=time.time()</span><br><span class="line">print(&apos;this is end_time &apos;,end_time)</span><br></pre></td></tr></table></figure>
<h2 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h2>
        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

