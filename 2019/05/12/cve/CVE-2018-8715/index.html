<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="damn1t"><meta name="renderer" content="webkit"><meta name="copyright" content="damn1t"><meta name="keywords" content="damn1t"><meta name="description" content="404"><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>CVE-2018-8715 · Damn1t's Blog</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/favicon.png"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="/img/assets/logo.png"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">Damn1t</div><div class="profile-signature">for you I bleed myself dry</div><div class="friends"><div>FRIENDS</div><span><a href="//www.baidu.com" target="_black">baidu</a></span></div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 70vh;background-image: url(/img/intro/index-bg.png);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">Damn1t's Blog</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div></i><div class="clear"></div></section></nav><h1 class="post-title">CVE-2018-8715</h1><div class="post-intros"><div class="post-intro-meta"><span class="post-intro-time"><i class="post-intro-calendar fa fa-calendar"></i><span>2019-05-12</span></span><span class="post-intro-tags"><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="cve"> cve</a></span></div></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><article class="article-entry" id="post"><h1 id="CVE-2018-8715"><a href="#CVE-2018-8715" class="headerlink" title="CVE-2018-8715"></a>CVE-2018-8715</h1><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>利用vulnhub的环境<br><code>docker-compose up -d</code>后台运行，端口设置不要改，默认<code>8080</code></p>
<h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><h3 id="Appweb简介"><a href="#Appweb简介" class="headerlink" title="Appweb简介"></a>Appweb简介</h3><p>Appweb是一个嵌入式HTTP Web服务器，主要的设计思路是安全。这是直接集成到客户的应用和设备，便于开发和部署基于Web的应用程序和设备。它迅速（ 每秒处理3500多要求）而紧凑 ，其中包括支持动态网页制作，服务器端嵌入式脚本过程中的CGI ，可加载模块的SSL ，摘要式身份验证，虚拟主机， Apache样式配置，日志记录，单和多线程应用程序。它提供了大量的文档和示例。</p>
<p>AppWeb是Embedthis Software LLC公司负责开发维护的一个基于GPL开源协议的嵌入式Web Server。他使用C/C++来编写，能够运行在几乎先进所有流行的操作系统上。当然他最主要的应用场景还是为嵌入式设备提供Web Application容器。</p>
<p>AppWeb可以进行认证配置，其认证方式包括以下三种：</p>
<ul>
<li>basic 传统HTTP基础认证</li>
<li>digest 改进版HTTP基础认证，认证成功后将使用Cookie来保存状态，而不用再传递Authorization头</li>
<li>form 表单认证</li>
</ul>
<h3 id="漏洞原理及复现"><a href="#漏洞原理及复现" class="headerlink" title="漏洞原理及复现"></a>漏洞原理及复现</h3><p>我复现的时候并没有如他人所说需要重置<code>session</code>，直接添加：<code>Authorization: Digest username=joshua</code><br><img src="https://i.loli.net/2019/05/11/5cd6eb191bdb6.png" alt=""></p>
<p>正常步骤是：<br>在添加了<code>Authorization: Digest username=joshua</code>之后，因为我们没有传入密码字段，所以服务端出现错误，直接返回了<code>200</code>，且包含一个<code>session</code>，于是再附上<code>session</code>：<br><img src="https://img-blog.csdnimg.cn/20190212222013874.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjkzNjU2Ng==,size_16,color_FFFFFF,t_70" alt=""></p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>其7.0.3之前的版本中，对于digest和form两种认证方式，如果用户传入的密码为<code>null</code>（也就是没有传递密码参<br>数），appweb将因为一个逻辑错误导致直接认证成功，并返回session。</p>
<p>漏洞位置在<a href="https://github.com/embedthis/appweb/blob/v7.0.2/paks/http/dist/httpLib.c" target="_blank" rel="noopener">appweb/paks/http/dist/httpLib.c</a></p>
<p>首先是<code>function authCondition()</code><br><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    This condition is used to implement all user authentication for routes</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> authCondition(HttpConn *conn, HttpRoute *route, HttpRouteOp *op)</span><br><span class="line">&#123;</span><br><span class="line">    HttpAuth    *auth;</span><br><span class="line">    cchar       *username, *password;</span><br><span class="line"></span><br><span class="line">    assert(conn);</span><br><span class="line">    assert(route);</span><br><span class="line"></span><br><span class="line">    auth = route-&gt;auth;</span><br><span class="line">    <span class="keyword">if</span> (!auth || !auth-&gt;type) &#123;</span><br><span class="line">        <span class="comment">/* Authentication not required */</span></span><br><span class="line">        <span class="keyword">return</span> HTTP_ROUTE_OK;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!httpIsAuthenticated(conn)) &#123;</span><br><span class="line">        httpGetCredentials(conn, &amp;username, &amp;password);</span><br><span class="line">        <span class="keyword">if</span> (!httpLogin(conn, username, password)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!conn-&gt;tx-&gt;finalized) &#123;</span><br><span class="line">                <span class="keyword">if</span> (auth &amp;&amp; auth-&gt;type) &#123;</span><br><span class="line">                    (auth-&gt;type-&gt;askLogin)(conn);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    httpError(conn, HTTP_CODE_UNAUTHORIZED, <span class="string">"Access Denied, login required"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">/* Request has been denied and a response generated. So OK to accept this route. */</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> HTTP_ROUTE_OK;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!httpCanUser(conn, <span class="keyword">NULL</span>)) &#123;</span><br><span class="line">        httpTrace(conn, <span class="string">"auth.check"</span>, <span class="string">"error"</span>, <span class="string">"msg:'Access denied, user is not authorized for access'"</span>);</span><br><span class="line">        <span class="keyword">if</span> (!conn-&gt;tx-&gt;finalized) &#123;</span><br><span class="line">            httpError(conn, HTTP_CODE_FORBIDDEN, <span class="string">"Access denied. User is not authorized for access."</span>);</span><br><span class="line">            <span class="comment">/* Request has been denied and a response generated. So OK to accept this route. */</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* OK to accept route. This does not mean the request was authenticated - an error may have been already generated */</span></span><br><span class="line">    <span class="keyword">return</span> HTTP_ROUTE_OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这个函数负责调用两个用于认证处理的函数：<code>getCredentials</code>和<code>httpLogin</code>，注意到<code>httpGetCredentials</code>周围缺少检查，这将会在稍后起到作用</p>
<p><code>httpGetCredentials()</code>:<br><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    Get the username and password credentials. If using an in-protocol auth scheme like basic|digest, the</span></span><br><span class="line"><span class="comment">    rx-&gt;authDetails will contain the credentials and the parseAuth callback will be invoked to parse.</span></span><br><span class="line"><span class="comment">    Otherwise, it is expected that "username" and "password" fields are present in the request parameters.</span></span><br><span class="line"><span class="comment">    This is called by authCondition which thereafter calls httpLogin</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">PUBLIC bool httpGetCredentials(HttpConn *conn, cchar **username, cchar **password)</span><br><span class="line">&#123;</span><br><span class="line">    HttpAuth    *auth;</span><br><span class="line"></span><br><span class="line">    assert(username);</span><br><span class="line">    assert(password);</span><br><span class="line">    *username = *password = NULL;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">auth</span> = conn-&gt;</span><span class="function"><span class="title">rx</span>-&gt;</span><span class="function"><span class="title">route</span>-&gt;</span>auth;</span><br><span class="line">    <span class="function"><span class="title">if</span> (!auth || !auth-&gt;</span>type) &#123;</span><br><span class="line">        return <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">if</span> (auth-&gt;</span>type) &#123;</span><br><span class="line">        <span class="function"><span class="title">if</span> (conn-&gt;</span><span class="function"><span class="title">authType</span> &amp;&amp; !smatch(conn-&gt;</span><span class="function"><span class="title">authType</span>, auth-&gt;</span><span class="function"><span class="title">type</span>-&gt;</span><span class="keyword">name</span>)) &#123;</span><br><span class="line">            <span class="function"><span class="title">if</span> (!(smatch(auth-&gt;</span><span class="function"><span class="title">type</span>-&gt;</span><span class="function"><span class="title">name</span>, "form") &amp;&amp; conn-&gt;</span><span class="function"><span class="title">rx</span>-&gt;</span>flags &amp; HTTP_POST)) &#123;</span><br><span class="line">                <span class="comment">/* If a posted form authentication, ignore any basic|digest details in request */</span></span><br><span class="line">                return <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="title">if</span> (auth-&gt;</span><span class="function"><span class="title">type</span>-&gt;</span><span class="function"><span class="title">parseAuth</span> &amp;&amp; (auth-&gt;</span><span class="function"><span class="title">type</span>-&gt;</span>parseAuth)(conn, username, password) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            return <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        *username = httpGetParam(conn, <span class="string">"username"</span>, <span class="number">0</span>);</span><br><span class="line">        *password = httpGetParam(conn, <span class="string">"password"</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    return <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>该函数接收两个指向数组的指针用于从请求中解析<code>username</code>和<code>password</code>。既然<code>authCondition</code>没有进行参数检查，那么<code>parseAuth</code>失败也无关紧要。这意味着我们能够插入<code>WWW-Authenticate header</code>或者post任何我们想要的认证数据</p>
<p><code>httpLogin()</code>：<br><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    Login the user and create an authenticated session state store</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">PUBLIC bool httpLogin(HttpConn *conn, cchar *username, cchar *password)</span><br><span class="line">&#123;</span><br><span class="line">    HttpRx          *rx;</span><br><span class="line">    HttpAuth        *auth;</span><br><span class="line">    HttpSession     *session;</span><br><span class="line">    HttpVerifyUser  verifyUser;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">rx</span> = conn-&gt;</span>rx;</span><br><span class="line">    <span class="function"><span class="title">auth</span> = rx-&gt;</span><span class="function"><span class="title">route</span>-&gt;</span>auth;</span><br><span class="line">    <span class="keyword">if</span> (!username || !*username) &#123;</span><br><span class="line">        httpTrace(conn, <span class="string">"auth.login.error"</span>, <span class="string">"error"</span>, <span class="string">"msg:'missing username'"</span>);</span><br><span class="line">        return <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">if</span> (!auth-&gt;</span>store) &#123;</span><br><span class="line">        mprLog(<span class="string">"error http auth"</span>, <span class="number">0</span>, <span class="string">"No AuthStore defined"</span>);</span><br><span class="line">        return <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">if</span> ((verifyUser = auth-&gt;</span>verifyUser) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="function"><span class="title">if</span> (!auth-&gt;</span><span class="function"><span class="title">parent</span> || (verifyUser = auth-&gt;</span><span class="function"><span class="title">parent</span>-&gt;</span>verifyUser) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="function"><span class="title">verifyUser</span> = auth-&gt;</span><span class="function"><span class="title">store</span>-&gt;</span>verifyUser;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!verifyUser) &#123;</span><br><span class="line">        <span class="function"><span class="title">mprLog</span>("error http auth", 0, "No user verification routine defined on route %s", rx-&gt;</span><span class="function"><span class="title">route</span>-&gt;</span>pattern);</span><br><span class="line">        return <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">if</span> (auth-&gt;</span><span class="function"><span class="title">username</span> &amp;&amp; *auth-&gt;</span>username) &#123;</span><br><span class="line">        <span class="comment">/* If using auto-login, replace the username */</span></span><br><span class="line">        <span class="function"><span class="title">username</span> = auth-&gt;</span>username;</span><br><span class="line">        password = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!(verifyUser)(conn, username, password)) &#123;</span><br><span class="line">        return <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">if</span> (!(auth-&gt;</span><span class="function"><span class="title">flags</span> &amp; HTTP_AUTH_NO_SESSION) &amp;&amp; !auth-&gt;</span><span class="function"><span class="title">store</span>-&gt;</span>noSession) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((session = httpCreateSession(conn)) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">/* Too many sessions */</span></span><br><span class="line">            return <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        httpSetSessionVar(conn, HTTP_SESSION_USERNAME, username);</span><br><span class="line">        <span class="function"><span class="title">httpSetSessionVar</span>(conn, HTTP_SESSION_IP, conn-&gt;</span>ip);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">rx</span>-&gt;</span>authenticated = <span class="number">1</span>;</span><br><span class="line">    <span class="function"><span class="title">rx</span>-&gt;</span>authenticateProbed = <span class="number">1</span>;</span><br><span class="line">    <span class="function"><span class="title">conn</span>-&gt;</span>username = sclone(username);</span><br><span class="line">    <span class="function"><span class="title">conn</span>-&gt;</span>encoded = <span class="number">0</span>;</span><br><span class="line">    return <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这一函数会检查username是否为空，当session已被分配时，<code>password</code>指针可以为空</p>
<p>为了能够绕过身份验证，我们需要能够传递空密码指针，幸运的是，对于表单和摘要身份验证，用于解析身份验证详细信息的函数（第1666行）将允许我们设置空密码指针，并且即使返回错误，最终也不会被authCondition检查，允许我们完全绕过身份验证，利用这个的唯一条件是知道hashmap中的用户名。</p>
<p>为了克服这个限制，必须考虑到散列映射的大小通常很小，并且散列映射中使用的散列算法（FNV）很弱：尝试次数有限，可能会发现冲突，并且登录不知道有效的用户名（未经测试）</p>
<p>reference：<br><a href="https://blog.csdn.net/weixin_42936566/article/details/87120710" target="_blank" rel="noopener">https://blog.csdn.net/weixin_42936566/article/details/87120710</a><br><a href="https://ssd-disclosure.com/archives/3676" target="_blank" rel="noopener">https://ssd-disclosure.com/archives/3676</a><br><a href="https://github.com/embedthis/appweb/issues/610" target="_blank" rel="noopener">https://github.com/embedthis/appweb/issues/610</a></p>
</article><!-- lincense--><div class="license-wrapper"><p> <span>Author:  </span><a href="http://microvorld.com">damn1t</a></p><p> <span>Link:  </span><a href="http://microvorld.com/2019/05/12/cve/CVE-2018-8715/">http://microvorld.com/2019/05/12/cve/CVE-2018-8715/</a></p><p> <span>Copyright:  </span><span>All articles in this blog are licensed under <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/3.0">CC BY-NC-SA 3.0</a> unless stating additionally.</span></p></div><div class="post-paginator"><a class="prevSlogan" href="/2019/05/20/web/Code-Breaking Puzzles/" title="Code-Breaking Puzzles"><span>< PreviousPost</span><br><span class="prevTitle">Code-Breaking Puzzles</span></a><a class="nextSlogan" href="/2019/05/09/vulnerable/intigriti xss challenge/" title="Intigriti XSS Challenge - Solution and problem solving approach"><span>NextPost ></span><br><span class="nextTitle">Intigriti XSS Challenge - Solution and problem solving approach</span></a><div class="clear"></div></div><div id="comment"></div></section></article><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by </span><a href="http://hexo.io"><span>Hexo</span></a><span> | theme </span><a href="https://github.com/Longlongyu/hexo-theme-Cxo"><span>Cxo</span></a></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span></div></footer><!-- catelog--><div class="toc-wrapper" style="top: 70vh;"><div class="toc-catalog"><i class="fa fa-list"> </i><span>CATALOG</span></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CVE-2018-8715"><span class="toc-number">1.</span> <span class="toc-text">CVE-2018-8715</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#环境搭建"><span class="toc-number">1.1.</span> <span class="toc-text">环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#复现"><span class="toc-number">1.2.</span> <span class="toc-text">复现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Appweb简介"><span class="toc-number">1.2.1.</span> <span class="toc-text">Appweb简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞原理及复现"><span class="toc-number">1.2.2.</span> <span class="toc-text">漏洞原理及复现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#原理"><span class="toc-number">1.3.</span> <span class="toc-text">原理</span></a></li></ol></li></ol></div><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i></body></html>